/*! For license information please see sfu.js.LICENSE.txt */
var SFU;(()=>{"use strict";var e={201:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatsType=t.WS_PINGS_MISSING_THRESHOLD=t.WS_PING_INTERVAL_MS=t.RoomState=t.State=t.SpaceEvent=t.RoomEvent=t.SfuEvent=t.SfuExtended=t.Sfu=t.sfuExtended=t.sfu=void 0;const i=n(406);Object.defineProperty(t,"Sfu",{enumerable:!0,get:function(){return i.Sfu}});const r=n(605);Object.defineProperty(t,"SfuExtended",{enumerable:!0,get:function(){return r.SfuExtended}});const s=n(494);Object.defineProperty(t,"SfuEvent",{enumerable:!0,get:function(){return s.SfuEvent}}),Object.defineProperty(t,"RoomEvent",{enumerable:!0,get:function(){return s.RoomEvent}}),Object.defineProperty(t,"SpaceEvent",{enumerable:!0,get:function(){return s.SpaceEvent}}),Object.defineProperty(t,"State",{enumerable:!0,get:function(){return s.State}}),Object.defineProperty(t,"RoomState",{enumerable:!0,get:function(){return s.RoomState}}),Object.defineProperty(t,"WS_PING_INTERVAL_MS",{enumerable:!0,get:function(){return s.WS_PING_INTERVAL_MS}}),Object.defineProperty(t,"WS_PINGS_MISSING_THRESHOLD",{enumerable:!0,get:function(){return s.WS_PINGS_MISSING_THRESHOLD}}),Object.defineProperty(t,"StatsType",{enumerable:!0,get:function(){return s.StatsType}}),t.sfu=new i.Sfu,t.sfuExtended=new r.SfuExtended},700:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PacedSender=t.BitrateTest=void 0;const r=n(614);t.BitrateTest=class{constructor(e){this._stopped=!1,this._failed=!1,this._eventBus=e,this._id=(0,r.v4)()}advisedBitrate(e,t){return i(this,void 0,void 0,(function*(){try{yield this._eventBus.startTest()}catch(e){return 0}const n=(new Date).getTime();let i=n;const r=this,a=new s(new class{send(e){return r._eventBus.send(e)}active(){return r._eventBus.active()}});let o=1e4,E=1,c=n,_=0;t&&(o=t);let l=[],d=0,u=1e3;for(a.setTargetBitrate(u),a.start();!this._stopped&&!this._failed&&i-n<e;){let e;i=(new Date).getTime();try{e=yield this._eventBus.requestTestStatus()}catch(e){this._failed=!0;continue}if(0===e)continue;const t=(new Date).getTime(),n=a._lastSentTime-e,r=a._window.getWindowSize(t);l.push(r);let s=0;for(let e=0;e<l.length;e++)s+=l[e];d=Math.ceil(s/l.length),this._listener.onStatusUpdate(d),l.length>30&&l.shift();const T=Math.min(300,n-E);n>300?(u*=T>0?1-T/(t-c):.9,_=0):n<100&&(0===_?_=.1*u:(_*=2,l=[]),u+=_),u=Math.min(o,u),u=Math.max(100,u),a.setTargetBitrate(u),E=n,c=i,yield new Promise((e=>setTimeout(e,300)))}a.stop();try{yield this._eventBus.stopTest()}catch(e){}return d}))}setListener(e){this._listener=e}interruptTest(){this._stopped=!0,this._currentSender&&this._currentSender.stop()}};class s{constructor(e){this._ended=!1,this._window=new a,this._targetBitrate=0,this._lastSeq=0,this._defaultPacketSize=20,this._lastSentTime=0,this._sink=e,this._id=(0,r.v4)()}start(){return i(this,void 0,void 0,(function*(){for(;!this._ended&&this._sink.active();){const e=(new Date).getTime(),t=this._window.getDynamicRate(this._defaultPacketSize,e,this._targetBitrate);for(let n=0;n<t.count;n++){const n=new Uint8Array(1024*t.size/8*.9);let i=e;for(let e=0;e<8;e++)n[e]=i%256,i=Math.floor(i/256);let r=this._lastSeq++;for(let e=8;e<10;e++)n[e]=r%256,r=Math.floor(r/256);this._sink.send(n)&&(this._window.processNext(t.size,e),this._lastSentTime=e)}yield new Promise((e=>setTimeout(e,t.sleep)))}}))}setTargetBitrate(e){this._targetBitrate=e}stop(){this._ended=!0}}t.PacedSender=s;class a{constructor(){this._window=new Array,this._cachedValue=0,this._timeCapacity=1e3}processNext(e,t){this._window.push({size:e,timestamp:t}),this._cachedValue+=e}getDynamicRate(e,t,n){const i=this.getWindowSize(t);if(n-i<e)return{count:0,sleep:100,size:0};const r=(n-i)/e;let s=1,a=1,o=e;if(r>20){let t;t=this._window.length>0?this._timeCapacity-(this._window[this._window.length-1].timestamp-this._window[0].timestamp):this._timeCapacity,s=50,a=r/(t/s),a=Math.min(a,n/e/(this._timeCapacity/s))}else r<=5?(o=e/4,s=1e3/(4*r)):s=1e3/r;return{count:a,sleep:s,size:o}}getWindowSize(e){if(!this._window[0])return 0;let t=e-this._window[0].timestamp;for(;t>this._timeCapacity&&0!==this._window.length;)this._cachedValue-=this._window.shift().size,this._window[0]&&(t=e-this._window[0].timestamp);return this._cachedValue}}},216:function(e,t,n){var i,r,s,a,o,E,c,_,l=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))},d=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},u=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentsTransferClient=void 0;const T=n(494),f=n(796),A=n(614);class S{constructor(e,t){i.add(this),s.set(this,T.State.NEW),a.set(this,void 0),o.set(this,void 0),E.set(this,void 0),d(this,a,e,"f"),d(this,o,t,"f")}downloadAttachment(e){return l(this,void 0,void 0,(function*(){const t=this;if(u(t,s,"f")===T.State.CONNECTED)throw new Error("Downloading failed");return new Promise(((n,a)=>l(this,void 0,void 0,(function*(){const l=u(S,r,"m",_).call(S,e),h=(0,A.v4)();d(t,E,new f.Connection((()=>{}),((e,r)=>{if(e===T.InternalApi.BINARY_DATA){const e=2,s=new Uint8Array(r)[e-1];if(u(t,o,"f")){if(u(t,o,"f").payload){const n=new Uint8Array(u(t,o,"f").payload.byteLength+(r.byteLength-e));n.set(new Uint8Array(u(t,o,"f").payload),0),n.set(new Uint8Array(r.slice(e,r.byteLength)),u(t,o,"f").payload.byteLength),u(t,o,"f").payload=n.buffer}else u(t,o,"f").payload=r.slice(e,r.byteLength);1===s?(u(t,i,"m",c).call(t,u(t,o,"f"),T.AttachmentState.DOWNLOADED),t.disconnect(),n(u(t,o,"f"))):u(t,i,"m",c).call(t,u(t,o,"f"),T.AttachmentState.PENDING)}}else console.error("Unknown binary data type "+e)}),(e=>{d(t,s,T.State.FAILED,"f"),a(new Error(T.ChatError.DOWNLOADING_ATTACHMENT_FAILED))}),(e=>{d(t,s,T.State.DISCONNECTED,"f"),a(new Error(T.ChatError.DOWNLOADING_ATTACHMENT_FAILED))})),"f"),yield u(t,E,"f").connect(l),d(t,s,T.State.CONNECTED,"f"),u(t,E,"f").send(T.InternalApi.GET_ATTACHMENT,{sessionId:u(t,o,"f").sessionId,internalMessageId:h})}))))}))}disconnect(){return l(this,void 0,void 0,(function*(){u(this,s,"f")!==T.State.DISCONNECTED&&(yield u(this,E,"f").close(),d(this,s,T.State.DISCONNECTED,"f"))}))}}t.AttachmentsTransferClient=S,r=S,s=new WeakMap,a=new WeakMap,o=new WeakMap,E=new WeakMap,i=new WeakSet,c=function(e,t){const n={targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId,messageId:e.messageId,id:e.attachmentId,name:e.name,state:t,downloadedSize:e.payload.byteLength};u(this,a,"f").notify(T.SfuEvent.MESSAGE_ATTACHMENT_STATE,n)},_=function(e,t){return{url:e,appName:T.InternalApi.Z_ATTACHMENTS_TRANSFER_APP,timeout:t||1e4,pingInterval:0,failedProbesThreshold:0,custom:{username:"",password:"",nickname:""}}}},82:function(e,t,n){var i,r=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},s=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentsTransferManager=void 0;const a=n(216);t.AttachmentsTransferManager=class{constructor(e){i.set(this,void 0),r(this,i,e,"f")}download(e,t){return new a.AttachmentsTransferClient(s(this,i,"f"),e).downloadAttachment(t)}},i=new WeakMap},796:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;const o=s(n(163)),E=n(494);class c{constructor(e,t,n,i){this.failedProbesThreshold=e,this.pingsMissing=0,this.interval=t,this.connection=n,this.logger=i||new o.default,i||(this.logger.setPrefix((()=>"[WSPingReceiver]")),this.logger.setVerbosity(o.Verbosity.INFO))}start(){if(this.failedProbesThreshold>0&&this.interval>0){const e=this;this.checkInterval=window.setInterval((function(){e.checkPingsReceived()}),this.interval)}}stop(){this.checkInterval&&(window.clearInterval(this.checkInterval),this.checkInterval=null)}success(){this.pingsMissing=0}checkPingsReceived(){this.pingsMissing++,this.pingsMissing>=this.failedProbesThreshold&&this.failure()}failure(){return a(this,void 0,void 0,(function*(){let e;e="Missing "+this.pingsMissing+" pings from server, connection seems to be down",this.logger.warn(e),yield this.connection.close({type:E.SfuEvent.CONNECTION_FAILED,reason:e})}))}}t.Connection=class{constructor(e,t,n,i,r){this.connected=!1,this.onMessage=e,this.onBinaryData=t,this.onError=n,this.onClose=i,this.logger=r||new o.default,r||(this.logger.setPrefix((()=>"[Connection]")),this.logger.setVerbosity(o.Verbosity.INFO)),this.pingChecker=null}connect(e){const t=void 0!==e.timeout?e.timeout:E.WS_CONNECTION_TIMEOUT,n=void 0!==e.failedProbesThreshold?e.failedProbesThreshold:E.WS_PINGS_MISSING_THRESHOLD,i=void 0!==e.pingInterval?e.pingInterval:E.WS_PING_INTERVAL_MS;this.ws=new WebSocket(e.url),this.ws.binaryType="arraybuffer";const r=this;return new Promise((function(s,a){3===r.ws.readyState&&a("Can't connect to websocket URL "+e.url),t>0&&(r.connectionTimeout=window.setInterval((function(){0===r.ws.readyState&&(r.logger.warn("WS connection timeout"),r.ws.close())}),t)),r.ws.onerror=function(e){r.stopPingChecking(),r.connected?r.onError(e):a(e),r.connected=!1},r.ws.onclose=function(e){r.logger.debug("WebSocket connection closed, reason "+e.reason),r.stopPingChecking(),r.connected?r.onClose(e):a(e),r.connected=!1},r.ws.onopen=function(){var t;clearInterval(r.connectionTimeout);let s={appKey:e.appName,mediaProviders:["WebRTC"],keepAlive:!0,authToken:null!==(t=e.authToken)&&void 0!==t?t:null,clientVersion:"0.5.28",clientOSVersion:window.navigator.appVersion,clientBrowserVersion:window.navigator.userAgent,custom:e.custom};n>0&&i>0&&(r.pingChecker=new c(n,i,r,r.logger),r.pingChecker.start()),r.send("connection",s)},r.ws.onmessage=function(e){let t,n;if(e.data instanceof ArrayBuffer)t=E.InternalApi.BINARY_DATA;else{let i=JSON.parse(e.data);t=i.message,n=i.data}switch(t){case"ping":r.send("pong",null);break;case"getUserData":r.connected=!0,s(n[0]);break;case"binaryData":r.onBinaryData(t,e.data);break;default:r.onMessage(t,n)}r.resetPingChecker(t)}}))}send(e,t){this.logger.info("==>",e,t),this.ws&&this.ws.send(JSON.stringify({message:e,data:[t]}))}sendBinaryData(e){this.logger.info("==>",e.size),this.ws&&this.ws.send(e)}close(e){return a(this,void 0,void 0,(function*(){if(this.ws){this.stopPingChecking();const t=this;return new Promise((function(n){t.ws.onclose=function(i){t.logger.debug("WebSocket connection closed, reason "+i.reason),t.connected&&(e?t.onError(e):t.onClose(i)),t.connected=!1,n()},t.ws.close()}))}}))}stopPingChecking(){this.pingChecker&&(this.pingChecker.stop(),this.pingChecker=null)}resetPingChecker(e){this.pingChecker&&(this.logger.debug("Reset pings checker by event:",e),this.pingChecker.success())}}},494:(e,t)=>{var n,i,r,s,a,o,E,c,_,l,d,u,T,f,A,S,h,I,N,R,p,C,m,O,D,v,M,y,P,g,w,U,L;Object.defineProperty(t,"__esModule",{value:!0}),t.StatsType=t.ATTACHMENT_ID_LENGTH=t.WS_PINGS_MISSING_THRESHOLD=t.WS_PING_INTERVAL_MS=t.WS_CONNECTION_TIMEOUT=t.AuthenticationStatus=t.ConnectionType=t.SortOrder=t.MessageAttachmentMediaType=t.ChatReceivePolicy=t.ChannelSendPolicy=t.ChatType=t.NotificationMode=t.PresenceStatus=t.MessageTargetEntityType=t.MessageAttachmentType=t.AttachmentState=t.DeliveryStatus=t.MessageState=t.ConferenceType=t.RemoteSdpType=t.ATTACHMENT_CHUNK_SIZE=t.ExamplesError=t.SpaceError=t.UserManagementError=t.UserInfoError=t.RoomError=t.ChatSectionsError=t.ChatError=t.ContactError=t.ConnectionError=t.InternalApi=t.TrackType=t.ParticipantRole=t.Operations=t.RoomState=t.State=t.ExamplesEvent=t.MeetingSyncEvent=t.SpaceEvent=t.RoomEvent=t.SfuEvent=void 0,(L=t.SfuEvent||(t.SfuEvent={})).CONNECTED="CONNECTED",L.FAILED="FAILED",L.CONNECTION_FAILED="CONNECTION_FAILED",L.DISCONNECTED="DISCONNECTED",L.MESSAGE="MESSAGE",L.USER_CHATS="USER_CHATS",L.CHAT_LOADED="CHAT_LOADED",L.CHAT_MESSAGES="CHAT_MESSAGES",L.CHAT_SEARCH_RESULT="CHAT_SEARCH_RESULT",L.NEW_CHAT="NEW_CHAT",L.CHAT_DELETED="CHAT_DELETED",L.CHAT_UPDATED="CHAT_UPDATED",L.CHAT_NOTIFICATION_SETTINGS_UPDATED="CHAT_NOTIFICATION_SETTINGS_UPDATED",L.CHAT_MUTED="CHAT_MUTED",L.CHAT_UNMUTED="CHAT_UNMUTED",L.MESSAGE_STATE="MESSAGE_STATE",L.MESSAGE_ATTACHMENT_STATE="MESSAGE_ATTACHMENT_STATE",L.LAST_READ_MESSAGE_UPDATED="LAST_READ_MESSAGE_UPDATED",L.UPDATE_MESSAGES_DELIVERY_STATUS="UPDATE_MESSAGES_DELIVERY_STATUS",L.PUBLIC_CHANNELS="PUBLIC_CHANNELS",L.USER_CALENDAR="USER_CALENDAR",L.NEW_CALENDAR_ENTRY="NEW_CALENDAR_ENTRY",L.REMOVE_CALENDAR_ENTRY="REMOVE_CALENDAR_ENTRY",L.UPDATE_CALENDAR_EVENT="UPDATE_CALENDAR_EVENT",L.ACK="ACK",L.ATTACHMENT_DATA="ATTACHMENT_DATA",L.USER_ROOMS="USER_ROOMS",L.ATTACHMENT="ATTACHMENT",L.SFU_USER_PMI_SETTINGS="SFU_USER_PMI_SETTINGS",L.UPDATE_USER_PMI_SETTINGS="UPDATE_USER_PMI_SETTINGS",L.USER_INFO="USER_INFO",L.USER_INFO_CHANGED="USER_INFO_CHANGED",L.CHAT_MESSAGE_EDITED="CHAT_MESSAGE_EDITED",L.CHAT_MESSAGE_DELETED="CHAT_MESSAGE_DELETED",L.REACTION_ON_MESSAGE_ADDED="REACTION_ON_MESSAGE_ADDED",L.REACTION_ON_MESSAGE_REMOVED="REACTION_ON_MESSAGE_REMOVED",L.SIGN_UP_STATUS="SIGN_UP_STATUS",L.RESET_PASSWORD_REQUEST_STATUS="RESET_PASSWORD_REQUEST_STATUS",L.CHAT_MESSAGES_COUNT="CHAT_MESSAGES_COUNT",L.FIRST_AND_LAST_CHAT_MESSAGE="FIRST_AND_LAST_CHAT_MESSAGE",L.UNREAD_MESSAGES_COUNT="UNREAD_MESSAGES_COUNT",L.UNREAD_MESSAGES_COUNT_UPDATE="UNREAD_MESSAGES_COUNT_UPDATE",L.MESSAGE_ATTACHMENTS_SEARCH_RESULT="MESSAGE_ATTACHMENTS_SEARCH_RESULT",L.LOAD_MESSAGES_WITH_MENTIONS_RESULT="LOAD_MESSAGES_WITH_MENTIONS_RESULT",L.SEND_MESSAGE_SYNC="SEND_MESSAGE_SYNC",L.AUTHENTICATION_STATUS="AUTHENTICATION_STATUS",L.NEW_MEETING="NEW_MEETING",L.USER_MEETINGS="USER_MEETINGS",L.USER_CONTACTS="USER_CONTACTS",L.NEW_INCOMING_FRIEND_INVITE="NEW_INCOMING_FRIEND_INVITE",L.NEW_OUTGOING_FRIEND_INVITE="NEW_OUTGOING_FRIEND_INVITE",L.INCOMING_FRIEND_INVITE_DELETED="INCOMING_FRIEND_INVITE_DELETED",L.OUTGOING_FRIEND_INVITE_DELETED="OUTGOING_FRIEND_INVITE_DELETED",L.USER_PRESENCE_STATUS_UPDATED="USER_PRESENCE_STATUS_UPDATED",L.NEW_CONTACT="NEW_CONTACT",L.CONTACT_UPDATED="CONTACT_UPDATED",L.CONTACT_DELETED="CONTACT_DELETED",L.CONTACT_PERSONAL_SETTINGS_UPDATED="CONTACT_PERSONAL_SETTINGS_UPDATED",L.USER_ENCRYPTION_INFO_ADDED="USER_ENCRYPTION_INFO_ADDED",L.USER_ENCRYPTION_INFO="USER_ENCRYPTION_INFO",(U=t.RoomEvent||(t.RoomEvent={})).CREATED="CREATED",U.ENDED="ENDED",U.AVAILABLE="AVAILABLE",U.FAILED="FAILED",U.ADD_TRACKS="ADD_TRACKS",U.REMOVE_TRACKS="REMOVE_TRACKS",U.MESSAGE="MESSAGE",U.CONTROL_MESSAGE="CONTROL_MESSAGE",U.JOINED="JOINED",U.LEFT="LEFT",U.FORCEFULLY_LEFT="FORCEFULLY_LEFT",U.PLACED_IN_LOBBY="PLACED_IN_LOBBY",U.PLACED_IN_WAITING_ROOM="PLACED_IN_WAITING_ROOM",U.DETACHED="DETACHED",U.EVICTED="EVICTED",U.DROPPED="DROPPED",U.REMOTE_SDP="REMOTE_SDP",U.TRACK_QUALITY_STATE="TRACK_QUALITY_STATE",U.OPERATION_FAILED="OPERATION_FAILED",U.WAITING_LIST="SFU_WAITING_LIST",U.WAITING_ROOM_UPDATE="SFU_WAITING_ROOM_UPDATE",U.MUTE_TRACKS="MUTE_TRACKS",U.PARTICIPANT_LIST="PARTICIPANT_LIST",U.ROLE_ASSIGNED="ROLE_ASSIGNED",U.ROLES_LIST="ROLES_LIST",U.ROOM_CONFIG="ROOM_CONFIG",U.ROOM_LOCKED="ROOM_LOCKED",U.ROOM_INITIAL_AUDIO_MUTED="ROOM_INITIAL_AUDIO_MUTED",U.ROOM_INITIAL_VIDEO_MUTED="ROOM_INITIAL_VIDEO_MUTED",U.ROOM_INITIAL_SCREEN_SHARING_MUTED="ROOM_INITIAL_SCREEN_SHARING_MUTED",U.ROOM_AUDIO_MUTED="ROOM_AUDIO_MUTED",U.ROOM_VIDEO_MUTED="ROOM_VIDEO_MUTED",U.ROOM_SCREEN_SHARING_MUTED="ROOM_SCREEN_SHARING_MUTED",U.ROOM_CHAT_MUTED="ROOM_CHAT_MUTED",U.ROOM_CAN_CHANGE_NICKNAME="ROOM_CAN_CHANGE_NICKNAME",U.ROOM_SCREEN_SHARING_MULTIPLE_SHARES="ROOM_SCREEN_SHARING_MULTIPLE_SHARES",U.ROOM_SCREEN_SHARING_EVERYONE_CAN_SHARE="ROOM_SCREEN_SHARING_EVERYONE_CAN_SHARE",U.ROOM_SCREEN_SHARING_EVERYONE_CAN_DO_SUBSEQUENT_SHARE="ROOM_SCREEN_SHARING_EVERYONE_CAN_DO_SUBSEQUENT_SHARE",U.PARTICIPANT_CONFIG="PARTICIPANT_CONFIG",U.SCREEN_SHARING_CONFIG="SCREEN_SHARING_CONFIG",U.PARTICIPANT_AUDIO_MUTED="PARTICIPANT_AUDIO_MUTED",U.PARTICIPANT_VIDEO_MUTED="PARTICIPANT_VIDEO_MUTED",U.PARTICIPANT_SCREEN_SHARING_MUTED="PARTICIPANT_SCREEN_SHARING_MUTED",U.PARTICIPANT_RENAMED="PARTICIPANT_RENAMED",U.STOP_SCREEN_SHARING="STOP_SCREEN_SHARING",U.STOP_TRACK="STOP_TRACK",U.BITRATE_TEST_STATUS="BITRATE_TEST_STATUS",U.ROOM_NAME_UPDATED="ROOM_NAME_UPDATED",U.ROOM_RECORD_STARTED="ROOM_RECORD_STARTED",U.ROOM_RECORD_STOPPED="ROOM_RECORD_STOPPED",U.ROOM_RECORD_PAUSED="ROOM_RECORD_PAUSED",U.ROOM_RECORD_FAILED="ROOM_RECORD_FAILED",(w=t.SpaceEvent||(t.SpaceEvent={})).USER_SPACES="USER_SPACES",w.SPACE_CREATED="SPACE_CREATED",w.NEW_SPACE="NEW_SPACE",w.SPACE_DELETED="SPACE_DELETED",w.SPACE_OVERVIEW_UPDATED="SPACE_OVERVIEW_UPDATED",w.NEW_SPACE_CATEGORY="NEW_SPACE_CATEGORY",w.SPACE_CATEGORY_DELETED="SPACE_CATEGORY_DELETED",w.SPACE_CATEGORY_UPDATED="SPACE_CATEGORY_UPDATED",w.NEW_SPACE_CHANNEL="NEW_SPACE_CHANNEL",w.SPACE_CHANNEL_UPDATED="SPACE_CHANNEL_UPDATED",w.SPACE_CHANNEL_DELETED="SPACE_CHANNEL_DELETED",w.SPACE_CHANNEL_MOVED="SPACE_CHANNEL_MOVED",w.NEW_SPACE_THREAD="NEW_SPACE_THREAD",w.SPACE_THREAD_DELETED="SPACE_THREAD_DELETED",w.SPACE_THREAD_UPDATED="SPACE_THREAD_UPDATED",w.ADDED_MEMBERS_TO_THREAD="ADDED_MEMBERS_TO_THREAD",w.REMOVED_MEMBER_FROM_THREAD="REMOVED_MEMBER_FROM_THREAD",w.SPACE_INVITE_CREATED="SPACE_INVITE_CREATED",w.SPACE_INVITE_REVOKED="SPACE_INVITE_REVOKED",w.NEW_SPACE_ROLE="NEW_SPACE_ROLE",w.SPACE_ROLE_UPDATED="SPACE_ROLE_UPDATED",w.SPACE_ROLE_DELETED="SPACE_ROLE_DELETED",w.USER_JOINED_TO_SPACE="USER_JOINED_TO_SPACE",w.USER_LEFT_SPACE="USER_LEFT_SPACE",w.ADDED_ROLE_TO_MEMBER="ADDED_ROLE_TO_MEMBER",w.REMOVED_ROLE_FROM_MEMBER="REMOVED_ROLE_FROM_MEMBER",w.ROLE_PERMISSION_SECTIONS="ROLE_PERMISSION_SECTIONS",w.USER_SPACE_NICKNAME_UPDATED="USER_SPACE_NICKNAME_UPDATED",w.SPACE_NOTIFICATION_SETTINGS_UPDATED="SPACE_NOTIFICATION_SETTINGS_UPDATED",w.SPACE_MUTED="SPACE_MUTED",w.SPACE_UNMUTED="SPACE_UNMUTED",w.CHANNEL_NOTIFICATION_SETTINGS_UPDATED="CHANNEL_NOTIFICATION_SETTINGS_UPDATED",w.CHANNEL_MUTED="CHANNEL_MUTED",w.CHANNEL_UNMUTED="CHANNEL_UNMUTED",w.THREAD_NOTIFICATION_SETTINGS_UPDATED="THREAD_NOTIFICATION_SETTINGS_UPDATED",w.THREAD_MUTED="THREAD_MUTED",w.THREAD_UNMUTED="THREAD_UNMUTED",(g=t.MeetingSyncEvent||(t.MeetingSyncEvent={})).MEETING_ENDED_SYNC="MEETING_ENDED_SYNC",g.JOINED_MEETING_SYNC="JOINED_MEETING_SYNC",g.LEFT_MEETING_SYNC="LEFT_MEETING_SYNC",g.EVICTED_SYNC="EVICTED_SYNC",g.ADD_TRACKS_SYNC="ADD_TRACKS_SYNC",g.REMOVE_TRACKS_SYNC="REMOVE_TRACKS_SYNC",g.MUTE_TRACKS_SYNC="MUTE_TRACKS_SYNC",g.PARTICIPANT_LIST_SYNC="PARTICIPANT_LIST_SYNC",g.MEETING_NAME_UPDATED_SYNC="MEETING_NAME_UPDATED_SYNC",(t.ExamplesEvent||(t.ExamplesEvent={})).FREE_EXAMPLES_USER="FREE_EXAMPLES_USER",(P=t.State||(t.State={})).NEW="NEW",P.PENDING="PENDING",P.CONNECTED="CONNECTED",P.AUTHENTICATED="AUTHENTICATED",P.DISCONNECTED="DISCONNECTED",P.FAILED="FAILED",(y=t.RoomState||(t.RoomState={})).NEW="NEW",y.PENDING="PENDING",y.JOINED="JOINED",y.FAILED="FAILED",y.DISPOSED="DISPOSED",(M=t.Operations||(t.Operations={})).ROOM_CREATE="ROOM_CREATE",M.ROOM_CREATE_FROM_EVENT="ROOM_CREATE_FROM_EVENT",M.ROOM_JOIN="ROOM_JOIN",M.ROOM_AVAILABLE="ROOM_AVAILABLE",M.ROOM_DESTROY="ROOM_DESTROY",M.ROOM_LEAVE="ROOM_LEAVE",M.SEND_MESSAGE="SEND_MESSAGE",M.SEND_CONTROL_MESSAGE="SEND_CONTROL_MESSAGE",M.USER_LIST="USER_LIST",M.USER_CALENDAR="USER_CALENDAR",M.ADD_CALENDAR_EVENT="ADD_CALENDAR_EVENT",M.REMOVE_CALENDAR_EVENT="REMOVE_CALENDAR_EVENT",M.UPDATE_CALENDAR_EVENT="UPDATE_CALENDAR_EVENT",M.ROOM_UPDATE="ROOM_UPDATE",M.MUTE_TRACKS="MUTE_TRACKS",M.ASSIGN_ROLE="ASSIGN_ROLE",M.SUBSCRIBE_TO_WAITING_PARTICIPANT="SUBSCRIBE_TO_WAITING_PARTICIPANT",M.UNSUBSCRIBE_FROM_WAITING_PARTICIPANT="UNSUBSCRIBE_FROM_WAITING_PARTICIPANT",M.MOVE_TO_WAITING_ROOM="MOVE_TO_WAITING_ROOM",M.CREATE_CHAT="CREATE_CHAT",M.DELETE_CHAT="DELETE_CHAT",M.RENAME_CHAT="RENAME_CHAT",M.LOAD_CHAT="LOAD_CHAT",M.LOAD_CHAT_MESSAGES="LOAD_CHAT_MESSAGES",M.SEARCH_CHAT_MESSAGES="SEARCH_CHAT_MESSAGES",M.ADD_MEMBER_TO_CHAT="ADD_MEMBER_TO_CHAT",M.REMOVE_MEMBER_FROM_CHAT="REMOVE_MEMBER_FROM_CHAT",M.UPDATE_CHAT_PREFERENCES="UPDATE_CHAT_PREFERENCES",M.GET_USER_CHATS="GET_USER_CHATS",M.UPDATE_CHAT_CONFIGURATION="UPDATE_CHAT_CONFIGURATION",M.GET_ACTIVE_ROOMS="GET_ACTIVE_ROOMS",M.ROOM_EXISTS="ROOM_EXISTS",M.LOAD_ATTACHMENT="LOAD_ATTACHMENT",M.CHANGE_QUALITY="CHANGE_QUALITY",M.RECLAIM_OWNER_RIGHTS="RECLAIM_OWNER_RIGHTS",M.CONFIGURE_WAITING_ROOM="CONFIGURE_WAITING_ROOM",M.AUTHORIZE_WAITING_LIST="AUTHORIZE_WAITING_LIST",M.ADD_CHAT_TO_FAVOURITES="ADD_CHAT_TO_FAVOURITES",M.REMOVE_CHAT_FROM_FAVOURITES="REMOVE_CHAT_FROM_FAVOURITES",M.INVITE_CONTACT="INVITE_CONTACT",M.REMOVE_CONTACT="REMOVE_CONTACT",M.CONFIRM_CONTACT="CONFIRM_CONTACT",M.ADD_CONTACT_TO_FAVOURITES="ADD_CONTACT_TO_FAVOURITES",M.REMOVE_CONTACT_FROM_FAVOURITES="REMOVE_CONTACT_FROM_FAVOURITES",M.CANCEL_UPLOAD_ATTACHMENTS="CANCEL_UPLOAD_ATTACHMENTS",M.ROOM_SET_LOCK="ROOM_SET_LOCK",M.ROOM_SET_INITIAL_AUDIO_MUTED="ROOM_SET_INITIAL_AUDIO_MUTED",M.ROOM_SET_INITIAL_VIDEO_MUTED="ROOM_SET_INITIAL_VIDEO_MUTED",M.ROOM_SET_INITIAL_SCREEN_SHARING_MUTED="ROOM_SET_INITIAL_SCREEN_SHARING_MUTED",M.ROOM_SET_AUDIO_MUTED="ROOM_SET_AUDIO_MUTED",M.ROOM_SET_VIDEO_MUTED="ROOM_SET_VIDEO_MUTED",M.ROOM_SET_SCREEN_SHARING_MUTED="ROOM_SET_SCREEN_SHARING_MUTED",M.ROOM_SET_CHAT_MUTED="ROOM_SET_CHAT_MUTED",M.ROOM_SET_CAN_CHANGE_NICKNAME="ROOM_SET_CAN_CHANGE_NICKNAME",M.ROOM_SET_SCREEN_SHARING_MULTIPLE_SHARES="ROOM_SET_SCREEN_SHARING_MULTIPLE_SHARES",M.ROOM_SET_SCREEN_SHARING_EVERYONE_CAN_SHARE="ROOM_SET_SCREEN_SHARING_EVERYONE_CAN_SHARE",M.ROOM_SET_SCREEN_SHARING_EVERYONE_CAN_DO_SUBSEQUENT_SHARE="ROOM_SET_SCREEN_SHARING_EVERYONE_CAN_DO_SUBSEQUENT_SHARE",M.PARTICIPANT_AUDIO_MUTED="PARTICIPANT_AUDIO_MUTED",M.PARTICIPANT_VIDEO_MUTED="PARTICIPANT_VIDEO_MUTED",M.PARTICIPANT_SCREEN_SHARING_MUTED="PARTICIPANT_SCREEN_SHARING_MUTED",M.RENAME_PARTICIPANT="RENAME_PARTICIPANT",M.TURN_OFF_PARTICIPANT_SCREEN_SHARING="TURN_OFF_PARTICIPANT_SCREEN_SHARING",M.GET_USER_INFO="GET_USER_INFO",M.CHANGE_USER_EMAIL="CHANGE_USER_EMAIL",M.CHANGE_USER_PASSWORD="CHANGE_USER_PASSWORD",M.CHANGE_USER_NICKNAME="CHANGE_USER_NICKNAME",M.CHANGE_USER_PHONE_NUMBER="CHANGE_USER_PHONE_NUMBER",M.CHANGE_USER_HOST_KEY="CHANGE_USER_HOST_KEY",M.CHANGE_USER_TIMEZONE="CHANGE_USER_TIMEZONE",M.EDIT_CHAT_MESSAGE="EDIT_CHAT_MESSAGE",M.DELETE_CHAT_MESSAGE="DELETE_CHAT_MESSAGE",M.SIGN_UP="SIGN_UP",M.REMOVE_USER="REMOVE_USER",M.RESET_PASSWORD="RESET_PASSWORD",M.GET_CHAT_MESSAGES_COUNT="GET_CHAT_MESSAGES_COUNT",M.SEARCH_MESSAGE_ATTACHMENTS="SEARCH_MESSAGE_ATTACHMENTS",M.LOAD_MESSAGES_WITH_MENTIONS="LOAD_MESSAGES_WITH_MENTIONS",M.LEASE_TRACK="LEASE_TRACK",(v=t.ParticipantRole||(t.ParticipantRole={})).OWNER="OWNER",v.ADMIN="ADMIN",v.PARTICIPANT="PARTICIPANT",(D=t.TrackType||(t.TrackType={})).AUDIO="AUDIO",D.VIDEO="VIDEO",(O=t.InternalApi||(t.InternalApi={})).Z_APP="sfuZClientApp",O.P_APP="sfuApp",O.Z_USER_MANAGEMENT_APP="sfuZUserManagementApp",O.Z_EXAMPLES_MANAGEMENT_APP="sfuZExamplesManagementApp",O.Z_ATTACHMENTS_TRANSFER_APP="sfuZAttachmentsTransferHandler",O.DEFAULT_METHOD="sfuCallback",O.BINARY_DATA="binaryData",O.JOIN_ROOM="joinRoom",O.CREATE_ROOM="createRoom",O.ROOM_AVAILABLE="roomAvailable",O.ROOM_EXISTS="roomExists",O.UPDATE_ROOM_STATE="updateRoomState",O.DESTROY_ROOM="destroyRoom",O.LEAVE_ROOM="leaveRoom",O.START_ROOM_RECORD="startRoomRecord",O.STOP_ROOM_RECORD="stopRoomRecord",O.EVICT_PARTICIPANT="evictParticipant",O.RENAME_PARTICIPANT="renameParticipant",O.CHANGE_QUALITY="changeQuality",O.CHANGE_SID="changeSid",O.CHANGE_TID="changeTid",O.AUTHORIZE_WAITING_LIST="authorizeWaitingList",O.MESSAGE="SFU_MESSAGE",O.MESSAGE_STATE="SFU_MESSAGE_STATE",O.MESSAGE_ATTACHMENT_STATE="SFU_MESSAGE_ATTACHMENT_STATE",O.SFU_ATTACHMENT_REQUEST_ACK="SFU_ATTACHMENT_REQUEST_ACK",O.USER_LIST="SFU_USER_LIST",O.USER_CALENDAR="SFU_USER_CALENDAR",O.USER_CHATS="SFU_USER_CHATS",O.PUBLIC_CHANNELS="SFU_PUBLIC_CHANNELS",O.CHAT_LOADED="SFU_CHAT_LOADED",O.NEW_CHAT="SFU_NEW_CHAT",O.CHAT_DELETED="SFU_CHAT_DELETED",O.CHAT_UPDATED="SFU_UPDATE_CHAT",O.CONTACT_UPDATED="SFU_CONTACT_UPDATE",O.CONTACT_INVITE="SFU_CONTACT_INVITE",O.CONTACT_REMOVED="SFU_CONTACT_REMOVED",O.GET_USER_LIST="getUserList",O.GET_USER_CALENDAR="getUserCalendar",O.GET_USER_PMI_SETTINGS="getUserPmiSettings",O.UPDATE_USER_PMI_SETTINGS="updateUserPmiSettings",O.ADD_CALENDAR_EVENT="addCalendarEvent",O.REMOVE_CALENDAR_EVENT="removeCalendarEvent",O.UPDATE_CALENDAR_EVENT="updateCalendarEvent",O.CREATE_ROOM_FROM_EVENT="createRoomFromEvent",O.MUTE_TRACK="muteTrack",O.MUTE_REMOTE_TRACK="muteRemoteTrack",O.SEND_MESSAGE="sendMessage",O.GET_ATTACHMENT="downloadAttachment",O.SEND_CONTROL_MESSAGE="sendControlMessage",O.MARK_MESSAGE_READ="markMessageRead",O.MARK_MESSAGE_UNREAD="markMessageUnread",O.ASSIGN_ROLE="assignRole",O.SUBSCRIBE_TO_WAITING_PARTICIPANT="subscribeToWaitingParticipant",O.UNSUBSCRIBE_FROM_WAITING_PARTICIPANT="unsubscribeFromWaitingParticipant",O.MOVE_TO_WAITING_ROOM="moveToWaitingRoom",O.CONFIGURE_WAITING_ROOM="configureWaitingRoom",O.TRACK_CONTENT_HEADER="a=content:",O.GET_USER_CHATS="getUserChats",O.GET_PUBLIC_CHANNELS="getPublicChannels",O.LOAD_CHAT="loadChat",O.LOAD_MESSAGES="loadMessages",O.SEARCH_CHAT_MESSAGES="searchChatMessages",O.GET_MESSAGES_COUNT="getMessagesCount",O.GET_FIRST_AND_LAST_MESSAGE="getFirstAndLastMessage",O.GET_UNREAD_MESSAGES_COUNT="getUnreadMessagesCount",O.CREATE_CHAT="createChat",O.DELETE_CHAT="deleteChat",O.RENAME_CHAT="renameChat",O.UPDATE_CHAT_NOTIFICATION_SETTINGS="updateChatNotificationSettings",O.MUTE_CHAT="muteChat",O.UNMUTE_CHAT="unmuteChat",O.ADD_MEMBER_TO_CHAT="addMemberToChat",O.REMOVE_MEMBER_FROM_CHAT="removeMemberFromChat",O.UPDATE_CHANNEL_SEND_POLICY="updateChannelSendPolicy",O.UPDATE_CHAT_RECEIVE_POLICY="updateChatReceivePolicy",O.ADD_CHANNEL_SEND_PERMISSION_LIST_MEMBER="addChannelSendPermissionListMember",O.REMOVE_CHANNEL_SEND_PERMISSION_LIST_MEMBER="removeChannelSendPermissionListMember",O.UPDATE_CHAT_CONFIGURATION="updateChatConfiguration",O.ADD_CHAT_TO_FAVOURITES="addChatToFavourites",O.REMOVE_CHAT_FROM_FAVOURITES="removeChatFromFavourites",O.UPDATE_CHAT_HIDING="updateChatHiding",O.ADD_CONTACT_TO_FAVOURITES="addContactToFavourites",O.REMOVE_CONTACT_FROM_FAVOURITES="removeContactFromFavourites",O.GET_ACTIVE_ROOMS="getActiveRooms",O.RECLAIM_OWNER_RIGHTS="reclaimOwnerRights",O.CANCEL_SENDING_ATTACHMENT="cancelSendingAttachment",O.SEND_MESSAGE_WITH_ATTACHMENTS="sendMessageWithAttachments",O.SET_ROOM_LOCK="setRoomLock",O.SET_ROOM_INITIAL_AUDIO_MUTED="setRoomInitialAudioMuted",O.SET_ROOM_INITIAL_VIDEO_MUTED="setRoomInitialVideoMuted",O.SET_ROOM_INITIAL_SCREEN_SHARING_MUTED="setRoomInitialScreenSharingMuted",O.SET_ROOM_AUDIO_MUTED="setRoomAudioMuted",O.SET_ROOM_VIDEO_MUTED="setRoomVideoMuted",O.SET_ROOM_SCREEN_SHARING_MUTED="setRoomScreenSharingMuted",O.SET_ROOM_CHAT_MUTED="setRoomChatMuted",O.SET_ROOM_CAN_CHANGE_NICKNAME="setRoomCanChangeNickname",O.SET_ROOM_SCREEN_SHARING_MULTIPLE_SHARES="setRoomScreenSharingMultipleShares",O.SET_ROOM_SCREEN_SHARING_EVERYONE_CAN_SHARE="setRoomScreenSharingEveryoneCanShare",O.SET_ROOM_SCREEN_SHARING_EVERYONE_CAN_DO_SUBSEQUENT_SHARE="setRoomScreenSharingEveryoneCanDoSubsequentShare",O.SET_PARTICIPANT_AUDIO_MUTED="setParticipantAudioMuted",O.SET_PARTICIPANT_VIDEO_MUTED="setParticipantVideoMuted",O.SET_PARTICIPANT_SCREEN_SHARING_MUTED="setParticipantScreenSharingMuted",O.TURN_OFF_PARTICIPANT_SCREEN_SHARING="turnOffParticipantScreenSharing",O.GET_USER_INFO="getUserInfo",O.CHANGE_USER_EMAIL="changeUserEmail",O.CHANGE_USER_PASSWORD="changeUserPassword",O.CHANGE_USER_NICKNAME="changeUserNickname",O.CHANGE_USER_PHONE_NUMBER="changeUserPhoneNumber",O.CHANGE_USER_HOST_KEY="changeUserHostKey",O.CHANGE_USER_TIMEZONE="changeUserTimezone",O.EDIT_MESSAGE="editMessage",O.DELETE_MESSAGE="deleteMessage",O.ADD_REACTION_ON_MESSAGE="addReactionOnMessage",O.REMOVE_REACTION_ON_MESSAGE="removeReactionOnMessage",O.SIGN_UP="signUp",O.ENSURE_USERNAME_AVAILABLE="ensureUsernameAvailable",O.REMOVE_USER="removeUser",O.RESET_PASSWORD_REQUEST="resetPasswordRequest",O.RESET_PASSWORD="resetPassword",O.SEARCH_MESSAGE_ATTACHMENTS="searchMessageAttachments",O.LOAD_MESSAGES_WITH_MENTIONS="loadMessagesWithMentions",O.LEASE_TRACK="leaseTrack",O.LOGOUT="logout",O.START_BITRATE_TEST="startBitrateTest",O.END_BITRATE_TEST="endBitrateTest",O.GET_TEST_LATENCY="getBitrateLatency",O.GET_USER_SPACES="getUserSpaces",O.CREATE_SPACE="createSpace",O.DELETE_SPACE="deleteSpace",O.LEAVE_SPACE="leaveSpace",O.UPDATE_SPACE_NOTIFICATION_SETTINGS="updateSpaceNotificationSettings",O.MUTE_SPACE="muteSpace",O.UNMUTE_SPACE="unmuteSpace",O.UPDATE_SPACE_OVERVIEW="updateSpaceOverview",O.CREATE_SPACE_CATEGORY="createSpaceCategory",O.DELETE_SPACE_CATEGORY="deleteSpaceCategory",O.UPDATE_SPACE_CATEGORY="updateSpaceCategory",O.CREATE_SPACE_CHANNEL="createSpaceChannel",O.UPDATE_SPACE_CHANNEL="updateSpaceChannel",O.MOVE_SPACE_CHANNEL="moveSpaceChannel",O.DELETE_SPACE_CHANNEL="deleteSpaceChannel",O.UPDATE_CHANNEL_NOTIFICATION_SETTINGS="updateChannelNotificationSettings",O.MUTE_CHANNEL="muteChannel",O.UNMUTE_CHANNEL="unmuteChannel",O.CREATE_SPACE_THREAD="createSpaceThread",O.UPDATE_SPACE_THREAD="updateSpaceThread",O.ADD_MEMBERS_TO_THREAD="addMembersToThread",O.REMOVE_MEMBER_FROM_THREAD="removeMemberFromThread",O.DELETE_SPACE_THREAD="deleteSpaceThread",O.UPDATE_THREAD_NOTIFICATION_SETTINGS="updateThreadNotificationSettings",O.MUTE_THREAD="muteThread",O.UNMUTE_THREAD="unmuteThread",O.GENERATE_SPACE_INVITE="generateNewSpaceInvite",O.REVOKE_SPACE_INVITE="revokeSpaceInvite",O.JOIN_SPACE_BY_INVITE_CODE="joinSpaceByInviteCode",O.ADD_SPACE_ROLE="addSpaceRole",O.UPDATE_SPACE_ROLE="updateSpaceRole",O.DELETE_SPACE_ROLE="deleteSpaceRole",O.ADD_ROLE_TO_MEMBER="addRoleToMember",O.REMOVE_ROLE_FROM_MEMBER="removeRoleFromMember",O.GET_ROLE_PERMISSIONS="getRolePermissions",O.CREATE_CHANNEL_MEETING="createChannelMeeting",O.CREATE_DIRECT_MEETING="createDirectMeeting",O.GET_CONTACTS="getContacts",O.ADD_FRIEND="addFriend",O.REMOVE_FRIEND="removeFriend",O.REVOKE_FRIEND_INVITE="revokeFriendInvite",O.ACCEPT_FRIEND_INVITE="acceptFriendInvite",O.REJECT_FRIEND_INVITE="rejectFriendInvite",O.UPDATE_CONTACT_VOLUME="updateContactVolume",O.UPDATE_PRESENCE_STATUS="updatePresenceStatus",O.UPDATE_ACTIVITY_STATUS="updateActivityStatus",O.GET_EXAMPLES_FREE_USER="getFreeUser",O.ADD_USER_ENCRYPTION_INFO="addUserEncryptionInfo",O.GET_USER_ENCRYPTION_INFO="getUserEncryptionInfo",O.UPDATE_SPACE_NICKNAME="updateSpaceNickname",(m=t.ConnectionError||(t.ConnectionError={})).CONNECTION_ALREADY_ESTABLISHED="Connection is already established.",m.CONNECTION_ALREADY_IN_PROGRESS="Connection is already in progress.",(t.ContactError||(t.ContactError={})).USER_CAN_NOT_SEND_INVITE_TO_HIMSELF="User can not send invite to himself",(C=t.ChatError||(t.ChatError={})).CAN_NOT_SEND_MESSAGE_WITHOUT_CONTENT="Can't send message without content",C.CAN_NOT_SEND_NULL_MESSAGE="Can't send null message",C.CAN_NOT_SEND_MESSAGE_WITHOUT_CHAT_ID="Can't send message without a chatId",C.USER_MUST_BE_A_CHAT_MEMBER_TO_SEND_MESSAGES="User must be a chat member to send messages",C.CAN_NOT_CANCEL_SENDING_ATTACHMENT="Can't cancel sending attachment",C.CAN_NOT_EDIT_MESSAGE_WITHOUT_MESSAGE_ID="Can't edit message without messageId",C.EDIT_MESSAGE_ERROR_CHAT_DOES_NOT_EXISTS="Failed to edit message, chat doesn't exist",C.EDIT_MESSAGE_ERROR_MESSAGE_DOES_NOT_EXISTS="Failed to edit message, message doesn't exist",C.EDIT_MESSAGE_ERROR_MESSAGE_CAN_NOT_BE_WITHOUT_CONTENT="Failed to edit message, message must have body or attachments",C.DELETE_MESSAGE_ERROR_CHAT_DOES_NOT_EXISTS="Failed to delete message, chat doesn't exist",C.DELETE_MESSAGE_ERROR_MESSAGE_DOES_NOT_EXISTS="Failed to delete message, message doesn't exist",C.CAN_NOT_ADD_MEMBER_TO_PRIVATE_CHAT="Adding a member to the private chat is not allowed",C.CAN_NOT_REMOVE_MEMBER_FROM_PRIVATE_CHAT="Removing a member from the private chat is not allowed",C.CAN_NOT_RENAME_PRIVATE_CHAT="Renaming the private chat is not allowed",C.INCORRECT_CHAT_ENCRYPTION_SETTINGS="Incorrect chat encryption settings",C.DOWNLOADING_ATTACHMENT_FAILED="Downloading failed",(t.ChatSectionsError||(t.ChatSectionsError={})).PAGE_NOT_FOUND="Page not found",(p=t.RoomError||(t.RoomError={})).AUTHORIZATION_FAILED="Authorization failed by owner",p.ROOM_DESTROYED="Room destroyed",p.WRONG_PIN="Wrong pin",p.NOT_FOUND="Room not found",p.NICKNAME_UNAVAILABLE="Nickname unavailable",p.NICKNAME_ALREADY_TAKEN="This nickname is already taken",p.ID_IS_NULL="id can't be null",p.EVENT_ID_IS_NULL="event.id can't be null",p.USER_ALREADY_JOINED="User already joined",p.CANCEL_JOIN_ROOM="Joining to room canceled by user",p.ROOM_IS_LOCKED="Room is locked",p.RENAMING_PROHIBITED="Renaming prohibited by the owner",p.TRACK_ALREADY_DISPOSED="Track already disposed",(R=t.UserInfoError||(t.UserInfoError={})).EMAIL_ADDRESS_ALREADY_TAKEN="User with this email already exists",R.CURRENT_PASSWORD_IS_INCORRECT="You entered incorrect current password",R.CURRENT_PASSWORD_IS_NULL="Current password can't be null",R.NEW_PASSWORD_IS_NULL="New password can't be null",R.PASSWORD_POLICY_ERROR="New password should be at least 6 characters",(N=t.UserManagementError||(t.UserManagementError={})).EMAIL_ADDRESS_ALREADY_TAKEN="User with this email already exists",N.USERNAME_ALREADY_IN_USE="Username is already in use",N.USER_NOT_FOUND="User not found",N.USER_IS_NOT_REMOVED="Failed to remove user",N.EMAIL_IS_NOT_VERIFIED="Email is not verified",N.OPERATION_FAILED_BY_DISCONNECT="Operation failed by disconnect",N.CONNECTION_ERROR="Connection error",N.CONNECTION_FAILED="Connection failed",N.EMAIL_VERIFICATION_DECLINED="Email verification is declined",N.EMAIL_VERIFICATION_FAILED_BY_TIMEOUT="Email verification failed by timeout",N.EMAIL_NOT_FOUND="Email not found",(I=t.SpaceError||(t.SpaceError={})).USER_ALREADY_JOINED="User already joined",I.RESTRICTED_ACCESS="Restricted access",I.UPDATE_NICKNAME_ACCESS_RIGHTS_ERROR="Only the owner or the user themselves can update the nickname",(h=t.ExamplesError||(t.ExamplesError={})).OPERATION_FAILED_BY_DISCONNECT="Operation failed by disconnect",h.CONNECTION_ERROR="Connection error",h.CONNECTION_FAILED="Connection failed",t.ATTACHMENT_CHUNK_SIZE=1e5,(S=t.RemoteSdpType||(t.RemoteSdpType={})).OFFER="offer",S.ANSWER="answer",S.ROLLBACK="rollback",(A=t.ConferenceType||(t.ConferenceType={})).GLOBAL="GLOBAL",A.CHANNEL="CHANNEL",A.DIRECT="DIRECT",(f=t.MessageState||(t.MessageState={})).NO_DELIVERY_NO_READ="NO_DELIVERY_NO_READ",f.PARTIAL_DELIVERY_NO_READ="PARTIAL_DELIVERY_NO_READ",f.PARTIAL_DELIVERY_PARTIAL_READ="PARTIAL_DELIVERY_PARTIAL_READ",f.FULL_DELIVERY_NO_READ="FULL_DELIVERY_NO_READ",f.FULL_DELIVERY_PARTIAL_READ="FULL_DELIVERY_PARTIAL_READ",f.FULL_DELIVERY_FULL_READ="FULL_DELIVERY_FULL_READ",f.PENDING_ATTACHMENTS="PENDING_ATTACHMENTS",f.DELIVERY_CANCELLED="DELIVERY_CANCELLED",f.DELETED="DELETED",(T=t.DeliveryStatus||(t.DeliveryStatus={})).PENDING="PENDING",T.DELIVERED="DELIVERED",T.READ="READ",(u=t.AttachmentState||(t.AttachmentState={})).PENDING="PENDING",u.UPLOADED="UPLOADED",u.DOWNLOADED="DOWNLOADED",u.CANCELLED="CANCELLED",(d=t.MessageAttachmentType||(t.MessageAttachmentType={})).file="file",d.picture="picture",(l=t.MessageTargetEntityType||(t.MessageTargetEntityType={})).CHAT="CHAT",l.CHANNEL="CHANNEL",l.THREAD="THREAD",(_=t.PresenceStatus||(t.PresenceStatus={})).ONLINE="ONLINE",_.IDLE="IDLE",_.DO_NOT_DISTURB="DO_NOT_DISTURB",_.OFFLINE="OFFLINE",(c=t.NotificationMode||(t.NotificationMode={})).DEFAULT="DEFAULT",c.ALL_MESSAGES="ALL_MESSAGES",c.MENTIONS_ONLY="MENTIONS_ONLY",c.NOTHING="NOTHING",(E=t.ChatType||(t.ChatType={})).PUBLIC="PUBLIC",E.PRIVATE="PRIVATE",(o=t.ChannelSendPolicy||(t.ChannelSendPolicy={})).EVERYONE="EVERYONE",o.ADMIN="ADMIN",o.ADMIN_AND_LIST="ADMIN_AND_LIST",(a=t.ChatReceivePolicy||(t.ChatReceivePolicy={})).EVERYONE="EVERYONE",a.OWNER_ONLY="OWNER_ONLY",a.NOBODY="NOBODY",(s=t.MessageAttachmentMediaType||(t.MessageAttachmentMediaType={})).media="media",s.other="other",(r=t.SortOrder||(t.SortOrder={}))[r.ASC=0]="ASC",r[r.DESC=1]="DESC",(i=t.ConnectionType||(t.ConnectionType={})).MAIN="MAIN",i.MEETING="MEETING",i.CHAT="CHAT",i.MEETING_CHAT="MEETING_CHAT",(t.AuthenticationStatus||(t.AuthenticationStatus={})).VERIFYING_BY_EMAIL="VERIFYING_BY_EMAIL",t.WS_CONNECTION_TIMEOUT=1e4,t.WS_PING_INTERVAL_MS=5e3,t.WS_PINGS_MISSING_THRESHOLD=5,t.ATTACHMENT_ID_LENGTH=36,(n=t.StatsType||(t.StatsType={})).INBOUND="inbound-rtp",n.OUTBOUND="outbound-rtp"},163:function(e,t){var n,i,r,s,a=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Verbosity=void 0,function(e){e[e.ERROR=0]="ERROR",e[e.WARN=1]="WARN",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.TRACE=4]="TRACE"}(s=t.Verbosity||(t.Verbosity={})),n=new WeakMap,i=new WeakMap,r=new WeakMap,t.default=class{constructor(){n.set(this,(()=>"")),i.set(this,s.ERROR),r.set(this,console),this.setPrefix=e=>{if("function"!=typeof e)throw new Error("Prefix must be a function");a(this,n,e,"f")},this.setVerbosity=e=>{a(this,i,e,"f")},this.error=(...e)=>{o(this,i,"f")>=s.ERROR&&o(this,r,"f").error(o(this,n,"f").call(this),...e)},this.warn=(...e)=>{o(this,i,"f")>=s.WARN&&o(this,r,"f").warn(o(this,n,"f").call(this),...e)},this.info=(...e)=>{o(this,i,"f")>=s.INFO&&o(this,r,"f").info(o(this,n,"f").call(this),...e)},this.debug=(...e)=>{o(this,i,"f")>=s.DEBUG&&o(this,r,"f").debug(o(this,n,"f").call(this),...e)},this.trace=(...e)=>{o(this,i,"f")>=s.TRACE&&o(this,r,"f").trace(o(this,n,"f").call(this),...e)}}getLogger(){return o(this,r,"f")}setLogger(e){a(this,r,e,"f")}}},980:function(e,t){var n,i=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},r=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n};Object.defineProperty(t,"__esModule",{value:!0}),t.Notifier=void 0,t.Notifier=class{constructor(){n.set(this,{})}add(e,t){if(!e)throw new TypeError("Event can't be null");if(!t||"function"!=typeof t)throw new Error("Callback needs to be a valid function");i(this,n,"f")[e]||(i(this,n,"f")[e]=[]),i(this,n,"f")[e].push(t)}remove(e,t){if(!e)throw new TypeError("Event can't be null");if(!t||"function"!=typeof t)throw new Error("Callback needs to be a valid function");i(this,n,"f")[e]||(i(this,n,"f")[e]=[]);let r=i(this,n,"f")[e].findIndex((e=>e===t));-1!==r&&i(this,n,"f")[e].splice(r,1)}notify(e,t){if(i(this,n,"f")[e])for(const r of i(this,n,"f")[e])r(t)}clear(){r(this,n,{},"f")}},n=new WeakMap},386:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reject=t.resolve=t.add=void 0;const n={};function i(e,t,i){if(n[e])throw new Error("Already have promise with id "+e);n[e]={resolve:t,reject:i}}function r(e,t){const n=a(e);return!!n&&(n.resolve(t),!0)}function s(e,t){const n=a(e);return!!n&&(n.reject(t),!0)}function a(e){const t=n[e];if(t)return delete n[e],t}t.add=i,t.resolve=r,t.reject=s,t.default={add:i,resolve:r,reject:s,promised:function(e){return void 0!==n[e]}}},618:function(e,t){var n,i=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},r=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.ResetPasswordHandler=void 0,t.ResetPasswordHandler=class{constructor(e){n.set(this,void 0),i(this,n,e,"f")}resetPassword(e){return r(this,n,"f").call(this,e)}},n=new WeakMap},81:function(e,t,n){var i,r,s,a,o,E,c,_=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))},l=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},d=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RoomExtended=void 0;const T=n(614),f=n(876),A=u(n(386)),S=n(494);class h extends f.Room{constructor(e,t,n,E,c,_,d,u,T,f,A,h){super(e,E,c,d,u,_),i.add(this),r.set(this,void 0),s.set(this,void 0),a.set(this,void 0),o.set(this,S.ConferenceType.GLOBAL),this._id=t,l(this,s,n,"f"),T.participantsConfig||(T.participantsConfig={}),l(this,r,T,"f"),l(this,a,f,"f"),A?this.logger.setPrefix((()=>"[Room] "+A())):this.logger.setPrefix((()=>"[Room]")),h&&l(this,o,h,"f")}config(){return d(this,r,"f")}waitingRoomEnabled(){return d(this,a,"f")}createRoom(){const e=this;return new Promise(((t,n)=>{const i=(0,T.v4)();A.default.add(i,t,n),e.connection.send(S.InternalApi.CREATE_ROOM,{name:e._name,pin:e._pin,internalMessageId:i})}))}sendControlMessage(e,t,n){const i=this;return new Promise(((r,s)=>{const a=(0,T.v4)();A.default.add(a,r,s),i.connection.send(S.InternalApi.SEND_CONTROL_MESSAGE,{roomId:i._id,broadcast:t,from:"",to:n,body:e,internalMessageId:a})}))}authorizeWaitingList(e,t){const n=this;return new Promise(((i,r)=>{const s=(0,T.v4)();A.default.add(s,i,r),n.connection.send(S.InternalApi.AUTHORIZE_WAITING_LIST,{id:n._id,userId:e,authorized:t,internalMessageId:s})}))}moveToWaitingRoom(e){const t=this;return new Promise(((n,i)=>{const r=(0,T.v4)();A.default.add(r,n,i),t.connection.send(S.InternalApi.MOVE_TO_WAITING_ROOM,{roomId:t._id,userId:e,internalMessageId:r})}))}configureWaitingRoom(e){const t=this;return new Promise(((n,i)=>{const r=(0,T.v4)();A.default.add(r,n,i),t.connection.send(S.InternalApi.CONFIGURE_WAITING_ROOM,{id:t._id,enabled:e,internalMessageId:r})}))}assignRole(e,t){const n=this;return new Promise(((i,r)=>{const s=(0,T.v4)();A.default.add(s,i,r),n.connection.send(S.InternalApi.ASSIGN_ROLE,{roomId:n._id,userId:e,role:t,internalMessageId:s})}))}reclaimOwnerRights(){const e=this;return new Promise(((t,n)=>{const i=(0,T.v4)();A.default.add(i,t,n),e.connection.send(S.InternalApi.RECLAIM_OWNER_RIGHTS,{roomId:e._id,internalMessageId:i})}))}subscribeToWaitingParticipant(e){const t=this;return new Promise(((n,i)=>{const r=(0,T.v4)();A.default.add(r,n,i),t.connection.send(S.InternalApi.SUBSCRIBE_TO_WAITING_PARTICIPANT,{roomId:t._id,userId:e,internalMessageId:r})}))}unsubscribeFromWaitingParticipant(e){const t=this;return new Promise(((n,i)=>{const r=(0,T.v4)();A.default.add(r,n,i),t.connection.send(S.InternalApi.UNSUBSCRIBE_FROM_WAITING_PARTICIPANT,{roomId:t._id,userId:e,internalMessageId:r})}))}setLock(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_LOCK,{id:t._id,value:e},n,r)}))}setInitialAudioMuted(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_INITIAL_AUDIO_MUTED,{id:t._id,value:e},n,r)}))}setInitialVideoMuted(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_INITIAL_VIDEO_MUTED,{id:t._id,value:e},n,r)}))}setInitialScreenSharingMuted(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_INITIAL_SCREEN_SHARING_MUTED,{id:t._id,value:e},n,r)}))}setAudioMuted(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_AUDIO_MUTED,{id:t._id,value:e},n,r)}))}setVideoMuted(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_VIDEO_MUTED,{id:t._id,value:e},n,r)}))}setScreenSharingMuted(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_SCREEN_SHARING_MUTED,{id:t._id,value:e},n,r)}))}setChatMuted(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_CHAT_MUTED,{id:t._id,value:e},n,r)}))}setCanChangeNickname(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_CAN_CHANGE_NICKNAME,{id:t._id,value:e},n,r)}))}setScreenSharingMultipleShares(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_SCREEN_SHARING_MULTIPLE_SHARES,{id:t._id,value:e},n,r)}))}setScreenSharingEveryoneCanShare(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_SCREEN_SHARING_EVERYONE_CAN_SHARE,{id:t._id,value:e},n,r)}))}setScreenSharingEveryoneCanDoSubsequentShare(e){const t=this;return new Promise(((n,r)=>{d(t,i,"m",c).call(t,S.InternalApi.SET_ROOM_SCREEN_SHARING_EVERYONE_CAN_DO_SUBSEQUENT_SHARE,{id:t._id,value:e},n,r)}))}setParticipantAudioMuted(e,t){const n=this;return new Promise(((r,s)=>{d(n,i,"m",c).call(n,S.InternalApi.SET_PARTICIPANT_AUDIO_MUTED,{id:n._id,value:t,userId:e},r,s)}))}setParticipantVideoMuted(e,t){const n=this;return new Promise(((r,s)=>{d(n,i,"m",c).call(n,S.InternalApi.SET_PARTICIPANT_VIDEO_MUTED,{id:n._id,value:t,userId:e},r,s)}))}setParticipantScreenSharingMuted(e,t){const n=this;return new Promise(((r,s)=>{d(n,i,"m",c).call(n,S.InternalApi.SET_PARTICIPANT_SCREEN_SHARING_MUTED,{id:n._id,value:t,userId:e},r,s)}))}turnOffParticipantScreenSharing(e,t){const n=this;return new Promise(((r,s)=>{d(n,i,"m",c).call(n,S.InternalApi.TURN_OFF_PARTICIPANT_SCREEN_SHARING,{id:n._id,userId:e,reason:t},r,s)}))}startRecord(){const e=this;return new Promise(((t,n)=>{const i=(0,T.v4)();A.default.add(i,t,n),e.connection.send(S.InternalApi.START_ROOM_RECORD,{id:e._id,internalMessageId:i})}))}stopRecord(){const e=this;return new Promise(((t,n)=>{const i=(0,T.v4)();A.default.add(i,t,n),e.connection.send(S.InternalApi.STOP_ROOM_RECORD,{id:e._id,internalMessageId:i})}))}processEvent(e){const t=Object.create(null,{updateName:{get:()=>super.updateName},processEvent:{get:()=>super.processEvent}});return _(this,void 0,void 0,(function*(){if(e.type===S.RoomEvent.ROOM_CONFIG){const t=e;d(this,r,"f").locked=t.config.locked,d(this,r,"f").initialAudioMuted=t.config.initialAudioMuted,d(this,r,"f").initialVideoMuted=t.config.initialVideoMuted,d(this,r,"f").initialScreenSharingMuted=t.config.initialScreenSharingMuted,d(this,r,"f").audioMuted=t.config.audioMuted,d(this,r,"f").videoMuted=t.config.videoMuted,d(this,r,"f").screenSharingMuted=t.config.screenSharingMuted,d(this,r,"f").chatMuted=t.config.chatMuted,d(this,r,"f").canChangeNickname=t.config.canChangeNickname,d(this,r,"f").screenSharingConfig=t.config.screenSharingConfig,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_LOCKED){const t=e.value;d(this,r,"f").locked=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_INITIAL_AUDIO_MUTED){const t=e.value;d(this,r,"f").initialAudioMuted=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_INITIAL_VIDEO_MUTED){const t=e.value;d(this,r,"f").initialVideoMuted=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_INITIAL_SCREEN_SHARING_MUTED){const t=e.value;d(this,r,"f").initialScreenSharingMuted=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_AUDIO_MUTED){const t=e.value;d(this,r,"f").audioMuted=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_VIDEO_MUTED){const t=e.value;d(this,r,"f").videoMuted=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_SCREEN_SHARING_MUTED){const t=e.value;d(this,r,"f").screenSharingMuted=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.STOP_SCREEN_SHARING){const t=e;d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_CHAT_MUTED){const t=e.value;d(this,r,"f").chatMuted=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_CAN_CHANGE_NICKNAME){const t=e.value;d(this,r,"f").canChangeNickname=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_SCREEN_SHARING_MULTIPLE_SHARES){const t=e.value;d(this,r,"f").screenSharingConfig.multipleShares=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_SCREEN_SHARING_EVERYONE_CAN_SHARE){const t=e.value;d(this,r,"f").screenSharingConfig.everyoneCanShare=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.ROOM_SCREEN_SHARING_EVERYONE_CAN_DO_SUBSEQUENT_SHARE){const t=e.value;d(this,r,"f").screenSharingConfig.everyoneCanDoSubsequentShare=t,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.PARTICIPANT_CONFIG){const t=e;d(this,r,"f").participantsConfig[t.userId]=t.config,d(this,i,"m",E).call(this,e,e.type,e)}else if(e.type===S.RoomEvent.SCREEN_SHARING_CONFIG){const t=e;d(this,r,"f").screenSharingConfig.multipleShares=t.config.multipleShares,d(this,r,"f").screenSharingConfig.everyoneCanShare=t.config.everyoneCanShare,d(this,r,"f").screenSharingConfig.everyoneCanDoSubsequentShare=t.config.everyoneCanDoSubsequentShare,d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.PARTICIPANT_AUDIO_MUTED){const t=e;d(this,r,"f").participantsConfig[t.userId].audioMuted=t.value,d(this,i,"m",E).call(this,e,e.type,t.value)}else if(e.type===S.RoomEvent.PARTICIPANT_VIDEO_MUTED){const t=e;d(this,r,"f").participantsConfig[t.userId].videoMuted=t.value,d(this,i,"m",E).call(this,e,e.type,t.value)}else if(e.type===S.RoomEvent.PARTICIPANT_SCREEN_SHARING_MUTED){const t=e;d(this,r,"f").participantsConfig[t.userId].screenSharingMuted=t.value,d(this,i,"m",E).call(this,e,e.type,t.value)}else if(e.type===S.RoomEvent.STOP_TRACK){const t=e;d(this,i,"m",E).call(this,e,e.type,t)}else if(e.type===S.RoomEvent.WAITING_ROOM_UPDATE){const t=e;l(this,a,t.enabled,"f"),A.default.promised(e.internalMessageId)?A.default.resolve(e.internalMessageId,t):this.notifier.notify(S.RoomEvent.WAITING_ROOM_UPDATE,t)}else if(e.type===S.RoomEvent.ROOM_NAME_UPDATED){const n=e;t.updateName.call(this,n.name),d(this,i,"m",E).call(this,e,e.type,n)}else t.processEvent.call(this,e)}))}owner(){return d(this,s,"f")}conferenceType(){return d(this,o,"f")}}t.RoomExtended=h,r=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,i=new WeakSet,E=function(e,t,n){A.default.resolve(e.internalMessageId,n)||this.notifier.notify(t,e)},c=function(e,t,n,i){const r=(0,T.v4)();A.default.add(r,n,i),this.connection.send(e,Object.assign(Object.assign({},t),{internalMessageId:r}))}},876:function(e,t,n){var i,r,s,a,o,E,c,_,l,d,u,T,f,A,S,h,I=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))},N=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},R=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Room=void 0;const C=n(614),m=p(n(386)),O=n(980),D=n(494),v=n(137),M=p(n(163)),y=n(125),P=n(17),g=n(700);class w{constructor(e,t,n,r,s,a){i.add(this),o.set(this,D.RoomState.NEW),E.set(this,D.ParticipantRole.PARTICIPANT),c.set(this,void 0),this.notifier=new O.Notifier,_.set(this,void 0),l.set(this,{}),d.set(this,void 0),u.set(this,void 0),T.set(this,void 0),f.set(this,void 0),this.connection=e,this._id=t,this._name=t,this._nickname=r,this._pin=n,this._userId=a,N(this,T,s,"f"),this.logger=new M.default,this._uid=(0,C.v4)(),this._crutch={mutex:new y.Mutex,tid:""},N(this,f,{audio:new P.Queue,video:new P.Queue},"f")}processEvent(e){return I(this,void 0,void 0,(function*(){if(this.logger.info("<==",e),e.type===D.RoomEvent.REMOTE_SDP){if(R(this,o,"f")!==D.RoomState.FAILED&&R(this,o,"f")!==D.RoomState.DISPOSED&&"closed"!==R(this,_,"f").signalingState){const t=e,n=this;switch(t.info.type){case D.RemoteSdpType.OFFER:this._crutch.mutex.runExclusive((()=>I(this,void 0,void 0,(function*(){n.logger.debug("Setting remote offer, tid "+t.info.tid);try{n._crutch.tid&&n._crutch.tid==t.info.tid||n.logger.debug("Tid mismatch, rollback. Remote tid "+t.info.tid+", local tid "+n._crutch.tid);let e=!1;"have-local-offer"===R(n,_,"f").signalingState&&(n.logger.debug("Rollback, tid "+t.info.tid),e=!0,yield R(n,i,"m",h).call(n,{info:{sdp:"",type:D.RemoteSdpType.ROLLBACK,tid:""}})),yield R(n,i,"m",h).call(n,t);const r=yield R(n,_,"f").createAnswer();if(r.sdp=r.sdp.replace(/a=sendrecv/g,"a=sendonly"),"closed"!==R(n,_,"f").connectionState){yield R(n,_,"f").setLocalDescription(r);const e=n._crutch.tid;n.logger.debug("Sent answer, remote tid "+t.info.tid+", local tid "+e),n.connection.send(D.InternalApi.UPDATE_ROOM_STATE,{id:n._id,pin:n._pin,sdp:R(n,_,"f").localDescription.sdp,tid:e,sdpType:D.RemoteSdpType.ANSWER})}if(e){n.logger.debug("Setting local reoffer, tid "+t.info.tid);const e=yield R(n,_,"f").createOffer();if(e.sdp=e.sdp.replace(/a=sendrecv/g,"a=sendonly"),"closed"!==R(n,_,"f").connectionState){yield R(n,_,"f").setLocalDescription(e);const i=n._crutch.tid;n.logger.debug("Sent reoffer,  remote tid "+t.info.tid+", local tid "+i),n.connection.send(D.InternalApi.UPDATE_ROOM_STATE,{id:n._id,pin:n._pin,sdp:e.sdp,internalMessageId:"",sdpType:D.RemoteSdpType.OFFER,tid:i})}}}catch(e){n.logger.error("Failed to process remote sdp, type "+t.info.type+", tid "+t.info.tid,e)}n.logger.debug("Ended setting remote offer with tid "+t.info.tid)}))));break;case D.RemoteSdpType.ANSWER:this._crutch.mutex.runExclusive((()=>I(this,void 0,void 0,(function*(){n.logger.debug("Setting remote answer, tid "+t.info.tid);try{if("have-local-offer"!==R(n,_,"f").signalingState)return void n.logger.debug("Reject remote answer, bad state");if(!n._crutch.tid||n._crutch.tid!=t.info.tid)return void n.logger.debug("Reject remote answer,bad tid "+t.info.tid);n.logger.debug("Apply remote answer with tid "+t.info.tid+", local tid "+n._crutch.tid),yield R(n,i,"m",h).call(n,t)}catch(e){n.logger.error("Failed to process remote sdp, type "+t.info.type+", tid "+t.info.tid,e)}n.logger.debug("Ended setting answer with tid "+t.info.tid)}))))}}}else if(e.type===D.RoomEvent.ROLE_ASSIGNED){const t=e;this._userId===t.userId&&N(this,E,t.role,"f"),this.notifier.notify(D.RoomEvent.ROLE_ASSIGNED,t)}else if(e.type===D.RoomEvent.CREATED){const t=e;N(this,c,t.inviteId,"f"),m.default.resolve(t.internalMessageId,e)||this.notifier.notify(D.RoomEvent.CREATED,t)}else if(e.type===D.RoomEvent.OPERATION_FAILED){const t=e;if(m.default.promised(t.internalMessageId)&&(t.operation===D.Operations.ROOM_JOIN&&(N(this,o,D.RoomState.DISPOSED,"f"),R(this,u,"f").close()),m.default.reject(t.internalMessageId,t)),t.operation===D.Operations.ROOM_JOIN&&t.error===D.RoomError.ROOM_DESTROYED)this.notifier.notify(D.RoomEvent.ENDED);else if(t.operation===D.Operations.ROOM_JOIN&&t.error===D.RoomError.AUTHORIZATION_FAILED){const e=Object.assign(Object.assign({},t),{userId:this._userId,name:this._nickname});this.notifier.notify(D.RoomEvent.EVICTED,e)}else if(t.operation===D.Operations.ROOM_JOIN&&t.error===D.RoomError.CANCEL_JOIN_ROOM){const e=Object.assign(Object.assign({},t),{userId:this._userId,name:this._nickname});this.notifier.notify(D.RoomEvent.LEFT,e)}else this.notifier.notify(D.RoomEvent.OPERATION_FAILED,t)}else if(e.type===D.RoomEvent.JOINED){const t=e;N(this,o,D.RoomState.JOINED,"f"),m.default.promised(t.internalMessageId)?(this._userId=t.userId,m.default.resolve(t.internalMessageId,t)):this.notifier.notify(D.RoomEvent.JOINED,t)}else if(e.type===D.RoomEvent.LEFT){const t=e;m.default.resolve(t.internalMessageId,t),this.notifier.notify(D.RoomEvent.LEFT,t)}else if(e.type===D.RoomEvent.FORCEFULLY_LEFT){const t=e;this.notifier.notify(D.RoomEvent.FORCEFULLY_LEFT,t)}else if(e.type===D.RoomEvent.PARTICIPANT_RENAMED){const t=e;this._userId===t.userId&&(this._nickname=t.updatedName),m.default.resolve(t.internalMessageId,t)||this.notifier.notify(D.RoomEvent.PARTICIPANT_RENAMED,t)}else if(e.type===D.RoomEvent.ADD_TRACKS){const t=e;m.default.resolve(t.internalMessageId,t)||this.notifier.notify(D.RoomEvent.ADD_TRACKS,t)}else if(e.type===D.RoomEvent.REMOVE_TRACKS){const t=e;m.default.resolve(t.internalMessageId,t)||this.notifier.notify(D.RoomEvent.REMOVE_TRACKS,t)}else if(e.type===D.RoomEvent.TRACK_QUALITY_STATE){const t=e;this.notifier.notify(D.RoomEvent.TRACK_QUALITY_STATE,t)}else if(e.type===D.RoomEvent.WAITING_ROOM_UPDATE){const t=e;m.default.promised(e.internalMessageId)?m.default.resolve(e.internalMessageId,t):this.notifier.notify(D.RoomEvent.WAITING_ROOM_UPDATE,t)}else if(e.type===D.SfuEvent.ACK&&m.default.promised(e.internalMessageId))m.default.resolve(e.internalMessageId);else if(e.type===D.RoomEvent.BITRATE_TEST_STATUS){const t=e;m.default.promised(e.internalMessageId)&&m.default.resolve(e.internalMessageId,t.latency)}else Object.values(D.RoomEvent).includes(e.type)&&this.notifier.notify(e.type,e)}))}join(e,t,n,E){const c=this;if(N(this,_,e,"f"),R(this,_,"f").addEventListener("signalingstatechange",(()=>{this.logger.debug("Connection "+c._uid+" "+R(c,_,"f").signalingState)})),t&&(this._nickname=t),E>0)for(let t=0;t<E;t++){let t=e.addTransceiver("video",{direction:"recvonly"});R(this,f,"f").video.enqueue(t)}N(this,d,R(this,_,"f").createDataChannel(R(w,r,"f",s)),"f");const T=R(this,_,"f").createDataChannel(R(w,r,"f",a));return N(this,u,new U(T),"f"),R(this,d,"f").onmessage=e=>{this.logger.info("dchannel ","<==",e);const t=JSON.parse(e.data);if(t.type===D.RoomEvent.MESSAGE){const e=t;if(-1!==e.message.message.indexOf('"payload":'))try{let n=JSON.parse(e.message.message);if(R(c,l,"f")[n.id]||(R(c,l,"f")[n.id]=[]),R(c,l,"f")[n.id].push(n),n.last){let i="";for(let e=0;e<R(c,l,"f")[n.id].length;e++)i+=R(c,l,"f")[n.id][e].payload;delete R(c,l,"f")[n.id],e.message.message=i,c.notifier.notify(t.type,e)}}catch(n){this.logger.info("Failed to process inner message: "+e.message),c.notifier.notify(t.type,e)}}else if(m.default.promised(t.internalMessageId)){if(t.type===D.SfuEvent.ACK)m.default.resolve(t.internalMessageId);else if(t.type===D.SfuEvent.FAILED){const e=t;m.default.reject(t.internalMessageId,e.error)}}else Object.values(D.RoomEvent).includes(t.type)&&c.notifier.notify(t.type,t)},this.stats=new v.WebRTCStats(R(this,_,"f")),new Promise(((e,r)=>I(this,void 0,void 0,(function*(){if(R(c,o,"f")===D.RoomState.NEW)try{const s=yield R(c,_,"f").createOffer();n&&(s.sdp=R(c,i,"m",S).call(c,s.sdp,n)),s.sdp=s.sdp.replace(/a=sendrecv/g,"a=sendonly"),yield R(c,_,"f").setLocalDescription(s);const a=(0,C.v4)();m.default.add(a,e,r),c._crutch.tid=(0,C.v4)(),c.connection.send(D.InternalApi.JOIN_ROOM,{id:c._id,pin:c._pin,sdp:s.sdp,nickname:t,internalMessageId:a,sdpType:D.RemoteSdpType.OFFER,tid:c._crutch.tid})}catch(e){r(e)}else r("Can't joined room with state "+R(this,o,"f"))}))))}updateState(e){const t=this;return new Promise(((n,r)=>I(this,void 0,void 0,(function*(){t._crutch.mutex.runExclusive((()=>I(this,void 0,void 0,(function*(){try{if(this.logger.debug("updateState "+this._nickname),"closed"===R(t,_,"f").signalingState)throw new Error("Bad state");const s=yield R(t,_,"f").createOffer();e&&(s.sdp=R(t,i,"m",S).call(t,s.sdp,e)),s.sdp=s.sdp.replace(/a=sendrecv/g,"a=sendonly"),yield R(t,_,"f").setLocalDescription(s);const a=(0,C.v4)();m.default.add(a,n,r);const o=(0,C.v4)();t._crutch.tid=o,t.logger.debug("Created tid "+o),t.connection.send(D.InternalApi.UPDATE_ROOM_STATE,{id:t._id,pin:t._pin,sdp:s.sdp,internalMessageId:a,sdpType:D.RemoteSdpType.OFFER,tid:o}),t.logger.debug("Sent local offer with tid "+o)}catch(e){t.logger.error("Reject update state "+e),r(e)}}))))}))))}destroyRoom(){const e=this;return new Promise(((t,n)=>{N(e,o,D.RoomState.DISPOSED,"f"),R(e,u,"f")&&R(e,u,"f").close();const i=(0,C.v4)();m.default.add(i,t,n),e.connection.send(D.InternalApi.DESTROY_ROOM,{id:e._id,pin:e._pin,internalMessageId:i})}))}getBitrateTest(){const e=this;if(R(this,o,"f")!==D.RoomState.JOINED)throw new Error("Room must be in joined state");const t=new g.BitrateTest(new class{active(){return R(e,o,"f")===D.RoomState.JOINED&&"connected"===R(e,_,"f").connectionState}requestTestStatus(){if(R(e,o,"f")!==D.RoomState.JOINED)throw new Error("Room must be in joined state");return new Promise(((t,n)=>{const i=(0,C.v4)();m.default.add(i,t,n),e.connection.send(D.InternalApi.GET_TEST_LATENCY,{roomId:e._id,internalMessageId:i})}))}send(t){return R(e,u,"f").send(t)}startTest(){if(R(e,o,"f")!==D.RoomState.JOINED)throw new Error("Room must be in joined state");return new Promise(((t,n)=>{const i=(0,C.v4)();m.default.add(i,t,n),e.connection.send(D.InternalApi.START_BITRATE_TEST,{roomId:e._id,internalMessageId:i})}))}stopTest(){if(R(e,o,"f")!==D.RoomState.JOINED)throw new Error("Room must be in joined state");return new Promise(((t,n)=>{if(R(e,u,"f")._closed)return void t();const i=(0,C.v4)();m.default.add(i,t,n),e.connection.send(D.InternalApi.END_BITRATE_TEST,{roomId:e._id,internalMessageId:i})}))}});return new class{test(e,n){return t.advisedBitrate(e)}stop(){t.interruptTest()}setListener(e){t.setListener(e)}}}leaveRoom(){const e=this;return new Promise(((t,n)=>{N(e,o,D.RoomState.DISPOSED,"f"),R(e,u,"f")&&R(e,u,"f").close();const i=(0,C.v4)();m.default.add(i,t,n),e.connection.send(D.InternalApi.LEAVE_ROOM,{id:e._id,pin:e._pin,internalMessageId:i}),R(e,_,"f")&&(R(e,_,"f").close(),"undefined"!=typeof document&&R(e,_,"f").dispatchEvent(new Event("connectionstatechange")))}))}evictParticipant(e){const t=this;return new Promise(((n,i)=>{const r=(0,C.v4)();m.default.add(r,n,i),t.connection.send(D.InternalApi.EVICT_PARTICIPANT,{id:t._id,userId:e,internalMessageId:r})}))}renameParticipant(e,t){const n=this;return new Promise(((i,r)=>{const s=(0,C.v4)();m.default.add(s,i,r),n.connection.send(D.InternalApi.RENAME_PARTICIPANT,{roomId:n._id,userId:e,newNickname:t,internalMessageId:s})}))}sendMessage(e){const t=this;return new Promise(((n,r)=>{const s=(0,C.v4)();if(m.default.add(s,n,r),e.length>16384){const n=e.match(new RegExp("(.|[\r\n]){1,16384}","g"));for(let e=0;e<n.length;e++)R(t,i,"m",A).call(t,JSON.stringify({id:s,last:e===n.length-1,payload:n[e]}))}else R(t,i,"m",A).call(t,JSON.stringify({id:s,payload:e}))}))}changeQuality(e,t,n){const i=this;return new Promise(((r,s)=>{const a=(0,C.v4)();m.default.add(a,r,s),i.connection.send(D.InternalApi.CHANGE_QUALITY,{roomId:i._id,id:e,quality:t,tid:n,internalMessageId:a})}))}muteTrack(e,t){const n=this;return new Promise(((i,r)=>{const s=(0,C.v4)();m.default.add(s,i,r),n.connection.send(D.InternalApi.MUTE_TRACK,{roomId:n._id,id:e,mute:t,internalMessageId:s})}))}muteRemoteTrack(e,t){const n=this;return new Promise(((i,r)=>{const s=(0,C.v4)();m.default.add(s,i,r),n.connection.send(D.InternalApi.MUTE_REMOTE_TRACK,{roomId:n._id,id:e,mute:t,internalMessageId:s})}))}on(e,t){return this.notifier.add(e,t),this}off(e,t){return this.notifier.remove(e,t),this}id(){return this._id}updateName(e){this._name=e}name(){return this._name}userId(){return this._userId}pin(){return this._pin}nickname(){return this._nickname}pc(){return R(this,_,"f")}role(){return R(this,E,"f")}invite(){return R(this,c,"f")}state(){return R(this,o,"f")}creationTime(){return R(this,T,"f")}getStats(e,t,n){this.stats.getStats(e,t,n)}getRemoteTrack(e,t){return I(this,void 0,void 0,(function*(){let n=R(this,f,"f")[e.toLowerCase()].dequeue();if(!n){if(!t)return;n=this.pc().addTransceiver(e.toLowerCase(),{direction:"recvonly"}),yield this.updateState()}const i=this;return{track:n.receiver.track,preferredQuality:void 0,tid:void 0,sid:void 0,disposed:!1,demandTrack(e){if(this.disposed&&e)return new Promise(((e,t)=>t(new Error(D.RoomError.TRACK_ALREADY_DISPOSED))));const t=this;return new Promise(((t,r)=>{const s=(0,C.v4)();m.default.add(s,t,r),i.connection.send(D.InternalApi.LEASE_TRACK,{roomId:i._id,remoteTrackId:e,localMid:n.mid,internalMessageId:s})})).catch((function(e){throw t.disposed||(t.disposed=!0,n.receiver&&n.receiver.track&&R(i,f,"f")[n.receiver.track.kind].enqueue(n)),e}))},mute(){return this.disposed?new Promise(((e,t)=>t(new Error(D.RoomError.TRACK_ALREADY_DISPOSED)))):i.muteRemoteTrack(n.mid,!0).then((()=>{n.receiver.track.enabled=!1}))},unmute(){return this.disposed?new Promise(((e,t)=>t(new Error(D.RoomError.TRACK_ALREADY_DISPOSED)))):(n.receiver.track.enabled=!0,i.muteRemoteTrack(n.mid,!1))},setPreferredQuality(e){if(this.disposed)return new Promise(((e,t)=>t()));const t=this;return new Promise(((r,s)=>{void 0!==e&&(t.preferredQuality=e);const a=(0,C.v4)();m.default.add(a,r,s),i.connection.send(D.InternalApi.CHANGE_QUALITY,{roomId:i._id,id:n.mid,quality:t.preferredQuality,internalMessageId:a})}))},setSid(e){if(this.disposed)return new Promise(((e,t)=>t()));this.sid=e;const t=this;return new Promise(((e,r)=>{const s=(0,C.v4)();m.default.add(s,e,r),i.connection.send(D.InternalApi.CHANGE_SID,{roomId:i._id,id:n.mid,sid:t.sid,internalMessageId:s})}))},setTid(e){if(this.disposed)return new Promise(((e,t)=>t()));this.tid=e;const t=this;return new Promise(((e,r)=>{const s=(0,C.v4)();m.default.add(s,e,r),i.connection.send(D.InternalApi.CHANGE_TID,{roomId:i._id,id:n.mid,tid:t.tid,internalMessageId:s})}))},dispose(){return I(this,void 0,void 0,(function*(){if(this.disposed)return new Promise(((e,t)=>t(new Error(D.RoomError.TRACK_ALREADY_DISPOSED))));this.disposed=!0;try{yield this.demandTrack(null)}catch(e){}finally{n.receiver&&n.receiver.track&&R(i,f,"f")[n.receiver.track.kind].enqueue(n)}}))}}}))}}t.Room=w,r=w,o=new WeakMap,E=new WeakMap,c=new WeakMap,_=new WeakMap,l=new WeakMap,d=new WeakMap,u=new WeakMap,T=new WeakMap,f=new WeakMap,i=new WeakSet,A=function(e){this.logger.info("dchannel ","==>",e),R(this,d,"f").send(e)},S=function(e,t){let n="";for(const i of e.split("\n"))if(i&&i.length>0&&(n+=i+"\n",i.indexOf("a=msid:")>-1)){const e=i.substring(i.indexOf(" ")+1).trim();t[e]&&(n+=D.InternalApi.TRACK_CONTENT_HEADER+t[e]+"\r\n")}return n},h=function(e){return I(this,void 0,void 0,(function*(){try{yield R(this,_,"f").setRemoteDescription(e.info)}catch(t){throw this.logger.warn(t),this.logger.debug("Was trying to set "+e.info.sdp),this.logger.debug("Local sdp is "+R(this,_,"f").localDescription.sdp),t}}))},s={value:"control"},a={value:"bitrate"};class U{constructor(e){this._queue=new P.Queue,this._highWatermark=524288,this._lowWatermark=262144,this._closed=!1,this._dc=e,this._dc.bufferedAmountLowThreshold=this._lowWatermark;const t=this;this._dc.onbufferedamountlow=function(){t.sendFirst()}}send(e){return!(this._closed||this._dc.bufferedAmount>this._highWatermark||(("string"==typeof e||e instanceof Uint8Array)&&this._dc.send(e),0))}close(){this._closed=!0}sendFirst(){if(this._queue.length>0){const e=this._queue.dequeue();this.send(e)}}}},579:function(e,t){var n,i=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},r=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.SendingAttachmentsHandler=void 0,t.SendingAttachmentsHandler=class{constructor(e){n.set(this,void 0),i(this,n,e,"f")}sendAttachments(){return r(this,n,"f").send()}cancelSendingAttachment(e){return r(this,n,"f").cancel(e)}waitAndGetMessageStatus(){return r(this,n,"f").waitAndGetMessageStatus()}getAttachmentsPayload(){return r(this,n,"f").getAttachmentsData()}},n=new WeakMap},605:function(e,t,n){var i,r,s,a,o,E,c,_,l,d,u,T,f,A,S,h,I,N,R,p,C,m=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),O=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),D=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return O(t,e),t},v=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))},M=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},y=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},P=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SfuExtended=void 0;const g=n(614),w=P(n(386)),U=n(796),L=n(494),G=n(980),H=n(81),b=n(579),F=D(n(163)),V=n(618),W=n(82);t.SfuExtended=class{constructor(e,t,n){i.add(this),r.set(this,void 0),s.set(this,void 0),a.set(this,void 0),o.set(this,void 0),E.set(this,L.State.NEW),c.set(this,{}),_.set(this,new G.Notifier),l.set(this,{}),d.set(this,new W.AttachmentsTransferManager(M(this,_,"f"))),u.set(this,void 0),T.set(this,new F.default),f.set(this,void 0),A.set(this,""),S.set(this,""),M(this,T,"f").setVerbosity(e||F.Verbosity.ERROR),t&&(y(this,f,t,"f"),M(this,T,"f").setPrefix(t)),n&&M(this,T,"f").setLogger(n),M(this,T,"f").setVerbosity(e||F.Verbosity.ERROR)}connect(e){if(!e)throw new TypeError("No options provided");if(M(this,E,"f")===L.State.PENDING)return Promise.reject(new Error(L.ConnectionError.CONNECTION_ALREADY_IN_PROGRESS));if(M(this,E,"f")===L.State.AUTHENTICATED)return Promise.reject(new Error(L.ConnectionError.CONNECTION_ALREADY_ESTABLISHED));y(this,E,L.State.PENDING,"f");const t={url:e.url,appName:L.InternalApi.Z_APP,timeout:e.timeout?e.timeout:1e4,failedProbesThreshold:e.failedProbesThreshold,pingInterval:e.pingInterval,authToken:e.authToken,custom:{username:e.username,password:e.password,nickname:e.nickname,device:e.device,details:e.details}},n=this;return M(this,i,"m",R).call(this),y(this,a,new URL(e.url).hostname,"f"),y(this,o,e.url,"f"),y(this,u,e.binaryChunkSize?e.binaryChunkSize:L.ATTACHMENT_CHUNK_SIZE,"f"),new Promise(((e,i)=>v(this,void 0,void 0,(function*(){try{const i=yield M(this,r,"f").connect(t);y(n,s,{username:i.sipLogin,email:i.email,nickname:i.sipVisibleName,authToken:i.authToken,pmi:i.pmi},"f"),y(n,E,L.State.AUTHENTICATED,"f"),M(n,_,"f").notify(L.SfuEvent.CONNECTED),e(M(n,s,"f"))}catch(e){y(n,E,L.State.FAILED,"f"),M(this,_,"f").notify(L.SfuEvent.FAILED,e),i(e)}}))))}disconnect(){return v(this,void 0,void 0,(function*(){for(const[e,t]of Object.entries(M(this,c,"f")))t.leaveRoom();y(this,s,void 0,"f"),M(this,E,"f")!==L.State.DISCONNECTED&&(yield M(this,r,"f").close(),y(this,E,L.State.DISCONNECTED,"f")),y(this,c,{},"f")}))}signUp(e){const t=M(this,i,"m",p).call(this,e.url,e.timeout),n=this;return new Promise(((i,s)=>v(this,void 0,void 0,(function*(){M(n,A,"f")&&w.default.promised(M(n,A,"f"))&&(w.default.reject(M(n,A,"f"),new Error(L.UserManagementError.EMAIL_IS_NOT_VERIFIED)),y(n,A,"","f")),M(n,E,"f")===L.State.CONNECTED&&(yield n.disconnect()),y(n,r,new U.Connection(((e,t)=>{if(e===L.InternalApi.DEFAULT_METHOD)if(t[0].type===L.SfuEvent.SIGN_UP_STATUS){const e=t[0];e.verified?(w.default.resolve(t[0].internalMessageId,e),y(n,A,"","f"),n.disconnect(),M(this,_,"f").notify(L.SfuEvent.SIGN_UP_STATUS,e)):M(this,_,"f").notify(L.SfuEvent.SIGN_UP_STATUS,e)}else t[0].type===L.RoomEvent.OPERATION_FAILED&&w.default.promised(t[0].internalMessageId)&&(w.default.reject(t[0].internalMessageId,t[0]),y(n,A,"","f"),n.disconnect())}),(()=>{}),(e=>{s(new Error(L.UserManagementError.CONNECTION_ERROR)),y(n,A,"","f"),y(n,E,L.State.FAILED,"f")}),(e=>{"Normal disconnect"===e.reason?(w.default.reject(M(n,A,"f"),new Error(L.UserManagementError.OPERATION_FAILED_BY_DISCONNECT)),y(n,E,L.State.DISCONNECTED,"f"),y(n,A,"","f"),n.disconnect()):(w.default.reject(M(n,A,"f"),new Error(L.UserManagementError.CONNECTION_FAILED)),y(n,E,L.State.DISCONNECTED,"f"),y(n,A,"","f"),n.disconnect())}),M(this,T,"f")),"f"),yield M(n,r,"f").connect(t),y(n,E,L.State.CONNECTED,"f");const a=(0,g.v4)();y(n,A,a,"f"),w.default.add(a,i,s),M(n,r,"f").send(L.InternalApi.SIGN_UP,{email:e.email,username:e.username,password:e.password,internalMessageId:a})}))))}ensureUsernameAvailable(e){const t=M(this,i,"m",p).call(this,e.url,e.timeout),n=(0,g.v4)(),s=this;return new Promise(((i,a)=>v(this,void 0,void 0,(function*(){M(s,E,"f")===L.State.CONNECTED&&(yield s.disconnect()),y(s,r,new U.Connection(((e,t)=>{e===L.InternalApi.DEFAULT_METHOD&&(t[0].type===L.SfuEvent.ACK&&w.default.promised(t[0].internalMessageId)?w.default.resolve(t[0].internalMessageId):t[0].type===L.RoomEvent.OPERATION_FAILED&&w.default.promised(t[0].internalMessageId)&&w.default.reject(t[0].internalMessageId,t[0]),s.disconnect())}),(()=>{}),(e=>{a(new Error(L.UserManagementError.CONNECTION_ERROR)),y(s,E,L.State.FAILED,"f")}),(e=>{"Normal disconnect"===e.reason?(w.default.reject(n,new Error(L.UserManagementError.OPERATION_FAILED_BY_DISCONNECT)),y(s,E,L.State.DISCONNECTED,"f")):(w.default.reject(n,new Error(L.UserManagementError.CONNECTION_FAILED)),y(s,E,L.State.DISCONNECTED,"f")),s.disconnect()}),M(this,T,"f")),"f"),yield M(s,r,"f").connect(t),y(s,E,L.State.CONNECTED,"f"),w.default.add(n,i,a),M(s,r,"f").send(L.InternalApi.ENSURE_USERNAME_AVAILABLE,{username:e.username,internalMessageId:n})}))))}resetPassword(e){const t=M(this,i,"m",p).call(this,e.url,e.timeout),n=this,s=()=>v(this,void 0,void 0,(function*(){return new Promise((function(t,i){const s=(0,g.v4)();y(n,S,s,"f"),w.default.add(s,t,i),M(n,r,"f").send(L.InternalApi.RESET_PASSWORD_REQUEST,{email:e.email,internalMessageId:s})}))})),a=t=>v(this,void 0,void 0,(function*(){return new Promise((function(i,s){const a=(0,g.v4)();y(n,S,a,"f"),w.default.add(a,i,s),M(n,r,"f").send(L.InternalApi.RESET_PASSWORD,{email:e.email,password:t,internalMessageId:a})}))}));return new Promise(((e,i)=>v(this,void 0,void 0,(function*(){let o;M(n,S,"f")&&w.default.promised(M(n,S,"f"))&&(w.default.reject(M(n,S,"f"),new Error(L.UserManagementError.EMAIL_IS_NOT_VERIFIED)),y(n,S,"","f")),M(n,E,"f")===L.State.CONNECTED&&(yield n.disconnect()),y(n,r,new U.Connection(((e,t)=>{if(e===L.InternalApi.DEFAULT_METHOD)if(t[0].type===L.SfuEvent.RESET_PASSWORD_REQUEST_STATUS){const e=t[0];e.confirmed?(w.default.resolve(t[0].internalMessageId,e),y(n,S,"","f"),M(this,_,"f").notify(L.SfuEvent.RESET_PASSWORD_REQUEST_STATUS,e)):M(this,_,"f").notify(L.SfuEvent.RESET_PASSWORD_REQUEST_STATUS,e)}else t[0].type===L.SfuEvent.ACK&&w.default.promised(t[0].internalMessageId)?(w.default.resolve(t[0].internalMessageId),y(n,S,"","f"),n.disconnect()):t[0].type===L.RoomEvent.OPERATION_FAILED&&w.default.promised(t[0].internalMessageId)&&(w.default.reject(t[0].internalMessageId,t[0]),y(n,S,"","f"),n.disconnect())}),(()=>{}),(e=>{i(new Error(L.UserManagementError.CONNECTION_ERROR)),y(n,E,L.State.FAILED,"f")}),(e=>{"Normal disconnect"===e.reason?(w.default.reject(M(n,S,"f"),new Error(L.UserManagementError.OPERATION_FAILED_BY_DISCONNECT)),y(n,S,"","f"),y(n,E,L.State.DISCONNECTED,"f"),n.disconnect()):(w.default.reject(M(n,S,"f"),new Error(L.UserManagementError.CONNECTION_FAILED)),y(n,S,"","f"),y(n,E,L.State.DISCONNECTED,"f"),n.disconnect())}),M(this,T,"f")),"f"),yield M(n,r,"f").connect(t),y(n,E,L.State.CONNECTED,"f");try{o=yield s()}catch(e){return void i(e)}o.confirmed&&e(new V.ResetPasswordHandler(a))}))))}removeUser(e){const t=M(this,i,"m",p).call(this,e.url,e.timeout),n=this;return new Promise(((i,s)=>v(this,void 0,void 0,(function*(){const a=(0,g.v4)();M(n,E,"f")===L.State.CONNECTED&&(yield n.disconnect()),y(n,r,new U.Connection(((e,t)=>{e===L.InternalApi.DEFAULT_METHOD&&(t[0].type===L.SfuEvent.ACK&&w.default.promised(t[0].internalMessageId)?w.default.resolve(t[0].internalMessageId):t[0].type===L.RoomEvent.OPERATION_FAILED&&w.default.promised(t[0].internalMessageId)&&w.default.reject(t[0].internalMessageId,t[0]),n.disconnect())}),(()=>{}),(e=>{s(new Error(L.UserManagementError.CONNECTION_ERROR)),y(n,E,L.State.FAILED,"f")}),(e=>{"Normal disconnect"===e.reason?(s(new Error(L.UserManagementError.OPERATION_FAILED_BY_DISCONNECT)),y(n,E,L.State.DISCONNECTED,"f"),n.disconnect()):(s(new Error(L.UserManagementError.CONNECTION_FAILED)),y(n,E,L.State.DISCONNECTED,"f"),n.disconnect())}),M(this,T,"f")),"f"),yield M(n,r,"f").connect(t),w.default.add(a,i,s),M(n,r,"f").send(L.InternalApi.REMOVE_USER,{id:e.id,internalMessageId:a})}))))}logout(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.LOGOUT,{},t,n)}))}loadMessages(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.LOAD_MESSAGES,e,n,r)}))}sendMessage(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",N).call(t),e?e.body&&""!==e.body||e.attachments&&0!==e.attachments.length?M(t,i,"m",h).call(t,L.InternalApi.SEND_MESSAGE,{to:e.to,parentId:e.parentId,body:e.body,targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId,attachments:e.attachments},n,r):r(new Error(L.ChatError.CAN_NOT_SEND_MESSAGE_WITHOUT_CONTENT)):r(new Error(L.ChatError.CAN_NOT_SEND_NULL_MESSAGE))}))}editMessage(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.EDIT_MESSAGE,{id:e.messageId,targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId,body:e.body,attachments:e.attachmentsToSend,attachmentIdsToDelete:e.attachmentIdsToDelete},n,r)}))}deleteMessage(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.DELETE_MESSAGE,{id:e.messageId,targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId},n,r)}))}addReactionOnMessage(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_REACTION_ON_MESSAGE,{targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId,messageId:e.messageId,reaction:e.reaction},n,r)}))}removeReactionOnMessage(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REMOVE_REACTION_ON_MESSAGE,{targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId,messageId:e.messageId,reaction:e.reaction},n,r)}))}markMessageRead(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){e?e.id&&""!==e.id?M(t,i,"m",h).call(t,L.InternalApi.MARK_MESSAGE_READ,{id:e.id,targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId},n,r):r(new Error("Can't mark message without massage id")):r(new Error("Can't mark null message"))}))}markMessageUnread(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){e?e.id&&""!==e.id?M(t,i,"m",h).call(t,L.InternalApi.MARK_MESSAGE_UNREAD,{id:e.id,targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId},n,r):r(new Error("Can't mark message without massage id")):r(new Error("Can't mark null message"))}))}getMessagesCount(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.GET_MESSAGES_COUNT,{targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId},n,r)}))}getFirstAndLastMessage(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.GET_FIRST_AND_LAST_MESSAGE,{targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId},n,r)}))}getUnreadMessagesCount(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.GET_UNREAD_MESSAGES_COUNT,{targetEntityType:e.targetEntityType,targetEntityId:e.targetEntityId},n,r)}))}static generateAttachmentId(){return(0,g.v4)()}getSendingAttachmentsHandler(e,t){const n=this,s=M(n,l,"f")[t];if(!s)return;const a=s.messageTransferId,o={};let E,c,_=!1;function d(e){return s.attachmentsInfo.find((t=>t.id===e)).attachmentTransferId}function T(e,t,r,s,a){return new Promise((function(o,E){w.default.add(t.toString()+r.toString(),o,E);const c=new Uint8Array(4);c[0]=10,c[1]=t,c[2]=r,c[3]=s;const _=a*M(n,u,"f"),l=new Blob([c,e.slice(_,_+M(n,u,"f"))]);M(n,i,"m",I).call(n,l)}))}function f(e){return v(this,void 0,void 0,(function*(){return new Promise((function(t,i){return v(this,void 0,void 0,(function*(){const{payload:i}=e,r=d(e.id),s=new Blob([i]),E=Math.ceil(s.size/M(n,u,"f"));for(let n=0;n<E;n++){let i=0;n===E-1&&(i=1);const c=o[e.id];if(void 0!==c){delete o[e.id],t(c.status);break}{const e=yield T(s,a,r,i,n);e.state===L.AttachmentState.UPLOADED&&t(e)}}}))}))}))}return new b.SendingAttachmentsHandler({send:()=>new Promise((function(s,l){return v(this,void 0,void 0,(function*(){if(M(n,i,"m",N).call(n),e.length){for(let t=0;t<e.length;t++){const n=e[t].id;void 0===o[n]?yield f(e[t]):delete o[n]}_=!0;const i=yield function(e){return new Promise((function(t,i){w.default.add(e,t,i),M(n,r,"f").send(L.InternalApi.SEND_MESSAGE_WITH_ATTACHMENTS,{id:e,transferId:a})}))}(t);E&&E.resolve(i),c=i,s(i)}else l(new Error("No attachments"))}))})),cancel:e=>new Promise((function(t,r){return v(this,void 0,void 0,(function*(){if(_)r(new Error(L.ChatError.CAN_NOT_CANCEL_SENDING_ATTACHMENT));else{const r=yield(s=e.id,new Promise((function(e,t){const r=d(s);M(n,i,"m",h).call(n,L.InternalApi.CANCEL_SENDING_ATTACHMENT,{messageTransferId:a,attachmentTransferId:r},e,t)})));r.uploadedSize!==e.size&&(o[e.id]={status:r}),t(r)}var s}))})),waitAndGetMessageStatus:()=>new Promise((function(e,t){c?e(c):E={resolve:e,reject:t}})),getAttachmentsData:()=>e})}getMessageAttachment(e){return v(this,void 0,void 0,(function*(){let t;try{t=yield this.downloadAttachment(e)}catch(e){throw e}return yield M(this,d,"f").download(t,M(this,o,"f"))}))}downloadAttachment(e){M(this,i,"m",N).call(this);const t=this,{targetEntityType:n,targetEntityId:r,messageId:s,attachmentId:a,name:o}=e;if(!s||""===s)throw new Error("Empty messageId");if(!o||""===o)throw new Error("Empty attachment name");if(null===a)throw new Error("Empty attachment id");return new Promise((function(e,E){M(t,i,"m",h).call(t,L.InternalApi.GET_ATTACHMENT,{targetEntityType:n,targetEntityId:r,messageId:s,attachmentId:a,name:o,size:M(t,u,"f")},e,E)}))}getContacts(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.GET_CONTACTS,{},t,n)}))}addFriend(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_FRIEND,{userId:e.userId},n,r)}))}removeFriend(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REMOVE_FRIEND,{userId:e.userId},n,r)}))}revokeFriendInvite(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REVOKE_FRIEND_INVITE,{inviteId:e.inviteId},n,r)}))}acceptFriendInvite(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ACCEPT_FRIEND_INVITE,{inviteId:e.inviteId},n,r)}))}rejectFriendInvite(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REJECT_FRIEND_INVITE,{inviteId:e.inviteId},n,r)}))}updateContactVolume(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_CONTACT_VOLUME,{userId:e.userId,value:e.value},n,r)}))}getUserCalendar(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.GET_USER_CALENDAR,{},t,n)}))}addCalendarEvent(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_CALENDAR_EVENT,{event:e},n,r)}))}removeCalendarEvent(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REMOVE_CALENDAR_EVENT,{event:e},n,r)}))}updateCalendarEvent(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_CALENDAR_EVENT,{event:e},n,r)}))}getUserPmiSettings(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.GET_USER_PMI_SETTINGS,{},t,n)}))}updateUserPmiSettings(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_USER_PMI_SETTINGS,Object.assign({},e),n,r)}))}getUserInfo(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.GET_USER_INFO,{},t,n)}))}changeUserEmail(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CHANGE_USER_EMAIL,{email:e},n,r)}))}changeUserPassword(e,t){M(this,i,"m",N).call(this);const n=this;return new Promise((function(r,s){M(n,i,"m",h).call(n,L.InternalApi.CHANGE_USER_PASSWORD,{password:{currentPassword:e,newPassword:t}},r,s)}))}changeUserNickname(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CHANGE_USER_NICKNAME,{nickname:e},n,r)}))}changeUserPhoneNumber(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CHANGE_USER_PHONE_NUMBER,{phoneNumber:e},n,r)}))}changeUserHostKey(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CHANGE_USER_HOST_KEY,{hostKey:e},n,r)}))}changeUserTimezone(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CHANGE_USER_TIMEZONE,{timezone:e},n,r)}))}updatePresenceStatus(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_PRESENCE_STATUS,{status:e},n,r)}))}updateActivityStatus(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_ACTIVITY_STATUS,{isActive:e},n,r)}))}addUserEncryptionInfo(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_USER_ENCRYPTION_INFO,{privateKey:e.privateKey,publicKey:e.publicKey,verificationHash:e.verificationHash,salt:e.salt,iv:e.iv},n,r)}))}getUserEncryptionInfo(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.GET_USER_ENCRYPTION_INFO,{},t,n)}))}getPublicChannels(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.GET_PUBLIC_CHANNELS,{},t,n)}))}searchChatMessages(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.SEARCH_CHAT_MESSAGES,e,n,r)}))}searchMessageAttachments(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.SEARCH_MESSAGE_ATTACHMENTS,{chatId:e.chatId,attachmentsType:e.attachmentsType,from:e.from,timeFrame:e.timeFrame,boundaries:e.boundaries,searchString:e.searchString,sortOrder:e.sortOrder},n,r)}))}loadMessagesWithMentions(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.LOAD_MESSAGES_WITH_MENTIONS,{chatId:e.chatId,userTag:e.userTag,timeFrame:e.timeFrame,boundaries:e.boundaries,sortOrder:e.sortOrder},n,r)}))}getUserChats(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.GET_USER_CHATS,{},t,n)}))}loadChat(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.LOAD_CHAT,{id:e.id},n,r)}))}createChat(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CREATE_CHAT,{id:e.id,name:e.name,members:e.members,favourite:e.favourite,channel:e.channel,type:e.type,channelSendPolicy:e.channelSendPolicy,sendPermissionList:e.sendPermissionList,allowedToAddExternalUser:e.allowedToAddExternalUser,encryptionEnabled:e.isEncryptionEnabled,encryptedPrivateKey:e.encryptedPrivateKey,publicKey:e.publicKey,encryptedChatPasswords:e.encryptedChatPasswords,encryptedAttachmentsSecretKey:e.encryptedAttachmentsSecretKey},n,r)}))}deleteChat(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.DELETE_CHAT,{id:e.id},n,r)}))}renameChat(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.RENAME_CHAT,{id:e.id,name:e.name},n,r)}))}updateChatNotificationSettings(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_CHAT_NOTIFICATION_SETTINGS,{id:e.id,value:e.value},n,r)}))}muteChat(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.MUTE_CHAT,{id:e.id,muteTime:e.muteTime,mutedIndefinitely:e.mutedIndefinitely},n,r)}))}unmuteChat(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UNMUTE_CHAT,{id:e.id},n,r)}))}addMemberToChat(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_MEMBER_TO_CHAT,{id:e.id,member:e.member,encryptedChatPassword:e.encryptedChatPassword},n,r)}))}removeMemberFromChat(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REMOVE_MEMBER_FROM_CHAT,{id:e.id,member:e.member},n,r)}))}updateChannelSendPolicy(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_CHANNEL_SEND_POLICY,{id:e.id,channelSendPolicy:e.channelSendPolicy},n,r)}))}updateChatReceivePolicy(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_CHAT_RECEIVE_POLICY,{id:e.id,chatReceivePolicy:e.chatReceivePolicy},n,r)}))}addChannelSendPermissionListMember(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_CHANNEL_SEND_PERMISSION_LIST_MEMBER,{id:e.id,member:e.member},n,r)}))}removeChannelSendPermissionListMember(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REMOVE_CHANNEL_SEND_PERMISSION_LIST_MEMBER,{id:e.id,member:e.member},n,r)}))}updateChatConfiguration(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_CHAT_CONFIGURATION,e,n,r)}))}addChatToFavourites(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_CHAT_TO_FAVOURITES,{id:e.id},n,r)}))}removeChatFromFavourites(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REMOVE_CHAT_FROM_FAVOURITES,{id:e.id},n,r)}))}updateChatHiding(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_CHAT_HIDING,{id:e.id,value:e.hidden},n,r)}))}createRoom(e){M(this,i,"m",N).call(this);const t=this;return new Promise(((n,r)=>{M(t,i,"m",h).call(t,L.InternalApi.CREATE_ROOM,{id:e.id,name:e.name,pin:e.pin},n,r)}))}createChannelMeeting(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CREATE_CHANNEL_MEETING,{spaceId:e.spaceId,channelId:e.channelId},n,r)}))}createDirectMeeting(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CREATE_DIRECT_MEETING,{directChatId:e.directChatId},n,r)}))}createRoomFromEvent(e){return M(this,i,"m",N).call(this),new Promise(((t,n)=>{M(this,i,"m",h).call(this,L.InternalApi.CREATE_ROOM_FROM_EVENT,{event:e},t,n)}))}loadActiveRooms(){const e=this;return new Promise(((t,n)=>{M(e,i,"m",h).call(e,L.InternalApi.GET_ACTIVE_ROOMS,{},t,n)}))}roomAvailable(e){M(this,i,"m",N).call(this);const t=this;return new Promise(((n,r)=>{M(t,i,"m",h).call(t,L.InternalApi.ROOM_AVAILABLE,{id:e.id,pin:e.pin},n,r)}))}roomExists(e){M(this,i,"m",N).call(this);const t=this;return new Promise(((n,r)=>{M(t,i,"m",h).call(t,L.InternalApi.ROOM_EXISTS,{id:e.id,pin:e.pin},n,r)}))}getRoom(e){if(!e)throw new TypeError("No options provided");return M(this,i,"m",N).call(this),M(this,c,"f")[e.id]}getUserSpaces(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.GET_USER_SPACES,{},t,n)}))}createSpace(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CREATE_SPACE,{name:e.name},n,r)}))}updateSpaceOverview(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_SPACE_OVERVIEW,{id:e.id,name:e.name},n,r)}))}deleteSpace(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.DELETE_SPACE,{id:e.id},n,r)}))}leaveSpace(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.LEAVE_SPACE,{id:e.id},n,r)}))}updateSpaceNotificationSettings(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_SPACE_NOTIFICATION_SETTINGS,{spaceId:e.spaceId,value:e.value},n,r)}))}muteSpace(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.MUTE_SPACE,{spaceId:e.spaceId,muteTime:e.muteTime,mutedIndefinitely:e.mutedIndefinitely},n,r)}))}unmuteSpace(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UNMUTE_SPACE,{spaceId:e.spaceId},n,r)}))}generateNewSpaceInvite(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.GENERATE_SPACE_INVITE,{spaceId:e.spaceId,lifespan:e.lifespan},n,r)}))}revokeSpaceInvite(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REVOKE_SPACE_INVITE,{spaceId:e.spaceId,inviteCode:e.inviteCode},n,r)}))}joinSpaceByInviteCode(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.JOIN_SPACE_BY_INVITE_CODE,{inviteCode:e},n,r)}))}createSpaceCategory(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CREATE_SPACE_CATEGORY,{spaceId:e.spaceId,name:e.name},n,r)}))}deleteSpaceCategory(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.DELETE_SPACE_CATEGORY,{spaceId:e.spaceId,categoryId:e.categoryId},n,r)}))}updateSpaceCategory(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_SPACE_CATEGORY,{spaceId:e.spaceId,categoryId:e.categoryId,name:e.name},n,r)}))}createSpaceChannel(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CREATE_SPACE_CHANNEL,{spaceId:e.spaceId,categoryId:e.categoryId,name:e.name,private:e.isPrivate,roles:e.roles,members:e.members},n,r)}))}updateSpaceChannel(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_SPACE_CHANNEL,{spaceId:e.spaceId,channelId:e.channelId,name:e.name,private:e.isPrivate,roles:e.roles,members:e.members},n,r)}))}moveSpaceChannel(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.MOVE_SPACE_CHANNEL,{spaceId:e.spaceId,categoryId:e.categoryId,channelId:e.channelId},n,r)}))}deleteSpaceChannel(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.DELETE_SPACE_CHANNEL,{spaceId:e.spaceId,channelId:e.channelId},n,r)}))}updateChannelNotificationSettings(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_CHANNEL_NOTIFICATION_SETTINGS,{spaceId:e.spaceId,channelId:e.channelId,value:e.value},n,r)}))}muteChannel(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.MUTE_CHANNEL,{spaceId:e.spaceId,channelId:e.channelId,muteTime:e.muteTime,mutedIndefinitely:e.mutedIndefinitely},n,r)}))}unmuteChannel(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UNMUTE_CHANNEL,{spaceId:e.spaceId,channelId:e.channelId},n,r)}))}createSpaceThread(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.CREATE_SPACE_THREAD,{spaceId:e.spaceId,channelId:e.channelId,name:e.name,private:e.isPrivate},n,r)}))}updateSpaceThread(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_SPACE_THREAD,{spaceId:e.spaceId,channelId:e.channelId,threadId:e.threadId,name:e.name},n,r)}))}addMembersToThread(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_MEMBERS_TO_THREAD,{spaceId:e.spaceId,channelId:e.channelId,threadId:e.threadId,members:e.members},n,r)}))}removeMemberFromThread(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REMOVE_MEMBER_FROM_THREAD,{spaceId:e.spaceId,channelId:e.channelId,threadId:e.threadId,member:e.member},n,r)}))}deleteSpaceThread(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.DELETE_SPACE_THREAD,{spaceId:e.spaceId,channelId:e.channelId,threadId:e.threadId},n,r)}))}updateThreadNotificationSettings(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_THREAD_NOTIFICATION_SETTINGS,{spaceId:e.spaceId,channelId:e.channelId,threadId:e.threadId,value:e.value},n,r)}))}muteThread(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.MUTE_THREAD,{spaceId:e.spaceId,channelId:e.channelId,threadId:e.threadId,muteTime:e.muteTime,mutedIndefinitely:e.mutedIndefinitely},n,r)}))}unmuteThread(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UNMUTE_THREAD,{spaceId:e.spaceId,channelId:e.channelId,threadId:e.threadId},n,r)}))}addSpaceRole(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_SPACE_ROLE,{spaceId:e.spaceId,roleName:e.name,color:e.color,permissions:e.permissions,members:e.members},n,r)}))}updateSpaceRole(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_SPACE_ROLE,{spaceId:e.spaceId,roleId:e.roleId,roleName:e.name,color:e.color,permissions:e.permissions,members:e.members},n,r)}))}deleteSpaceRole(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.DELETE_SPACE_ROLE,{spaceId:e.spaceId,roleId:e.roleId},n,r)}))}addRoleToMember(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.ADD_ROLE_TO_MEMBER,{spaceId:e.spaceId,roleId:e.roleId,memberId:e.memberId},n,r)}))}removeRoleFromMember(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.REMOVE_ROLE_FROM_MEMBER,{spaceId:e.spaceId,roleId:e.roleId,memberId:e.memberId},n,r)}))}getRolePermissions(){M(this,i,"m",N).call(this);const e=this;return new Promise((function(t,n){M(e,i,"m",h).call(e,L.InternalApi.GET_ROLE_PERMISSIONS,{},t,n)}))}updateSpaceNickname(e){M(this,i,"m",N).call(this);const t=this;return new Promise((function(n,r){M(t,i,"m",h).call(t,L.InternalApi.UPDATE_SPACE_NICKNAME,{spaceId:e.spaceId,userId:e.userId,nickname:e.nickname},n,r)}))}user(){return M(this,s,"f")}server(){return M(this,a,"f")}state(){return M(this,E,"f")}on(e,t){return M(this,_,"f").add(e,t),this}off(e,t){return M(this,_,"f").remove(e,t),this}getExamplesFreeUser(e){const t=M(this,i,"m",C).call(this,e.url,e.timeout),n=this,s=(0,g.v4)();return new Promise(((e,i)=>v(this,void 0,void 0,(function*(){M(n,E,"f")===L.State.CONNECTED&&(yield n.disconnect()),y(n,r,new U.Connection(((e,t)=>{if(e===L.InternalApi.DEFAULT_METHOD)if(t[0].type===L.ExamplesEvent.FREE_EXAMPLES_USER){const e=t[0];w.default.resolve(t[0].internalMessageId,e.user),n.disconnect()}else t[0].type===L.RoomEvent.OPERATION_FAILED&&w.default.promised(t[0].internalMessageId)&&(w.default.reject(t[0].internalMessageId,t[0]),n.disconnect())}),(()=>{}),(e=>{i(new Error(L.ExamplesError.CONNECTION_FAILED)),y(n,E,L.State.FAILED,"f")}),(e=>{"Normal disconnect"===e.reason?(w.default.reject(s,new Error(L.ExamplesError.OPERATION_FAILED_BY_DISCONNECT)),y(n,E,L.State.DISCONNECTED,"f"),n.disconnect()):(w.default.reject(s,new Error(L.ExamplesError.CONNECTION_FAILED)),y(n,E,L.State.DISCONNECTED,"f"),n.disconnect())}),M(this,T,"f")),"f"),yield M(n,r,"f").connect(t),y(n,E,L.State.CONNECTED,"f"),w.default.add(s,e,i),M(n,r,"f").send(L.InternalApi.GET_EXAMPLES_FREE_USER,{internalMessageId:s})}))))}static strToUTF8Array(e){let t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(n++,i=(1023&i)<<10|1023&e.charCodeAt(n),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t}static fromUTF8ArrayToStr(e){let t="";for(let n=0;n<e.byteLength;n++){let i=e[n];if(i<128)t+=String.fromCharCode(i);else if(i>191&&i<224)t+=String.fromCharCode((31&i)<<6|63&e[n+1]),n+=1;else if(i>223&&i<240)t+=String.fromCharCode((15&i)<<12|(63&e[n+1])<<6|63&e[n+2]),n+=2;else{let r=((7&i)<<18|(63&e[n+1])<<12|(63&e[n+2])<<6|63&e[n+3])-65536;t+=String.fromCharCode(r>>10|55296,1023&r|56320),n+=3}}return t}closePcAndFireEvent(e){M(this,c,"f")[e.id()].pc()&&(M(this,c,"f")[e.id()].pc().close(),"undefined"!=typeof document&&M(this,c,"f")[e.id()].pc().dispatchEvent(new Event("connectionstatechange")))}},r=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,E=new WeakMap,c=new WeakMap,_=new WeakMap,l=new WeakMap,d=new WeakMap,u=new WeakMap,T=new WeakMap,f=new WeakMap,A=new WeakMap,S=new WeakMap,i=new WeakSet,h=function(e,t,n,i){const s=(0,g.v4)();w.default.add(s,n,i),M(this,r,"f").send(e,Object.assign(Object.assign({},t),{internalMessageId:s}))},I=function(e){M(this,r,"f").sendBinaryData(e)},N=function(){if(M(this,E,"f")!==L.State.AUTHENTICATED)throw new Error("User isn't authenticated, current state "+M(this,E,"f"))},R=function(){const e=this;y(this,r,new U.Connection(((e,t)=>{switch(M(this,T,"f").debug("onMessage: ",t[0]),e){case L.InternalApi.DEFAULT_METHOD:if(t[0].type===L.InternalApi.MESSAGE){const e=t[0].message;M(this,_,"f").notify(L.SfuEvent.MESSAGE,e)}else if(t[0].type===L.InternalApi.MESSAGE_STATE){const e=t[0];e.waitingUploadingAttachments&&(M(this,l,"f")[e.status.id]=e.messageWithUploadingAttachments),w.default.resolve(t[0].internalMessageId,e.status)||M(this,_,"f").notify(L.SfuEvent.MESSAGE_STATE,e.status)}else if(t[0].type===L.InternalApi.MESSAGE_ATTACHMENT_STATE){const e=t[0];w.default.resolve(t[0].internalMessageId,e.status),M(this,_,"f").notify(L.SfuEvent.MESSAGE_ATTACHMENT_STATE,e.status)}else if(t[0].type===L.SfuEvent.LAST_READ_MESSAGE_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.LAST_READ_MESSAGE_UPDATED,e)}else if(t[0].type===L.SfuEvent.UPDATE_MESSAGES_DELIVERY_STATUS){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.UPDATE_MESSAGES_DELIVERY_STATUS,e)}else if(t[0].type===L.InternalApi.SFU_ATTACHMENT_REQUEST_ACK){const e=t[0],n=e.attachmentRequest;w.default.resolve(t[0].internalMessageId,Object.assign(Object.assign({},n),{payload:null,sessionId:e.sessionId,internalMessageId:e.internalMessageId}))}else if(t[0].type===L.InternalApi.USER_CALENDAR){const e=t[0];w.default.resolve(t[0].internalMessageId,e.calendar),M(this,_,"f").notify(L.SfuEvent.USER_CALENDAR,e.calendar)}else if(t[0].type===L.SfuEvent.NEW_CALENDAR_ENTRY){const e=t[0];w.default.resolve(t[0].internalMessageId,e.entry)||M(this,_,"f").notify(L.SfuEvent.NEW_CALENDAR_ENTRY,e.entry)}else if(t[0].type===L.SfuEvent.REMOVE_CALENDAR_ENTRY){const e=t[0];w.default.resolve(t[0].internalMessageId,e.entry)||M(this,_,"f").notify(L.SfuEvent.REMOVE_CALENDAR_ENTRY,e.entry)}else if(t[0].type===L.SfuEvent.UPDATE_CALENDAR_EVENT){const e=t[0];w.default.resolve(t[0].internalMessageId,e.entry)||M(this,_,"f").notify(L.SfuEvent.UPDATE_CALENDAR_EVENT,e.entry)}else if(t[0].type===L.SfuEvent.SFU_USER_PMI_SETTINGS){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.SFU_USER_PMI_SETTINGS,e)}else if(t[0].type===L.SfuEvent.UPDATE_USER_PMI_SETTINGS){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.UPDATE_USER_PMI_SETTINGS,e)}else if(t[0].type===L.InternalApi.NEW_CHAT){const e=t[0];w.default.resolve(t[0].internalMessageId,e.info)||M(this,_,"f").notify(L.SfuEvent.NEW_CHAT,e.info)}else if(t[0].type===L.InternalApi.CHAT_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e.info)||M(this,_,"f").notify(L.SfuEvent.CHAT_DELETED,e.info)}else if(t[0].type===L.InternalApi.CHAT_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e.info)||M(this,_,"f").notify(L.SfuEvent.CHAT_UPDATED,e.info)}else if(t[0].type===L.SfuEvent.CHAT_NOTIFICATION_SETTINGS_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.CHAT_NOTIFICATION_SETTINGS_UPDATED,e)}else if(t[0].type===L.SfuEvent.CHAT_MUTED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.CHAT_MUTED,e)}else if(t[0].type===L.SfuEvent.CHAT_UNMUTED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.CHAT_UNMUTED,e)}else if(t[0].type===L.InternalApi.USER_CHATS){const e=t[0];w.default.resolve(t[0].internalMessageId,e.chats),M(this,_,"f").notify(L.SfuEvent.USER_CHATS,e.chats)}else if(t[0].type===L.InternalApi.PUBLIC_CHANNELS){const e=t[0];w.default.resolve(t[0].internalMessageId,e.channels),M(this,_,"f").notify(L.SfuEvent.PUBLIC_CHANNELS,e.channels)}else if(t[0].type===L.InternalApi.CHAT_LOADED){const e=t[0];w.default.resolve(t[0].internalMessageId,e.chat),M(this,_,"f").notify(L.SfuEvent.CHAT_LOADED,e.chat)}else if(t[0].type===L.SfuEvent.CHAT_MESSAGES){const e=t[0];w.default.resolve(t[0].internalMessageId,e.messages),M(this,_,"f").notify(L.SfuEvent.CHAT_MESSAGES,e)}else if(t[0].type===L.SfuEvent.CHAT_SEARCH_RESULT){const e=t[0];w.default.resolve(t[0].internalMessageId,e.messages),M(this,_,"f").notify(L.SfuEvent.CHAT_SEARCH_RESULT,e)}else if(t[0].type===L.RoomEvent.CREATED){const e=t[0],n=new H.RoomExtended(M(this,r,"f"),e.roomId,e.owner,e.name,e.pin,this.user().username,this.user().nickname,e.creationTime,e.config,e.waitingRoomEnabled,M(this,f,"f"),e.conferenceType);M(this,c,"f")[n.id()]=n;const i=this,s=()=>{i.closePcAndFireEvent(n),delete M(i,c,"f")[n.id()]};n.on(L.RoomEvent.LEFT,(function(e){e.userId===n.userId()&&s()})).on(L.RoomEvent.FORCEFULLY_LEFT,(function(e){e.userId===n.userId()&&s()})).on(L.RoomEvent.EVICTED,(function(e){e.userId===n.userId()&&s()})).on(L.RoomEvent.DROPPED,(function(e){e.userId===n.userId()&&s()})).on(L.RoomEvent.ENDED,s).on(L.RoomEvent.FAILED,s).on(L.RoomEvent.OPERATION_FAILED,(function(e){L.Operations.ROOM_JOIN===e.operation&&s()})),w.default.resolve(t[0].internalMessageId,n)}else if(t[0].type===L.RoomEvent.AVAILABLE){const e=t[0],n=new H.RoomExtended(M(this,r,"f"),e.roomId,e.owner,e.name,e.pin,this.user().username,this.user().nickname,e.creationTime,e.config,e.waitingRoomEnabled,M(this,f,"f"),e.conferenceType);M(this,c,"f")[n.id()]=n;const i=this,s=()=>{i.closePcAndFireEvent(n),delete M(i,c,"f")[n.id()]};n.on(L.RoomEvent.LEFT,(function(e){e.userId===n.userId()&&s()})).on(L.RoomEvent.EVICTED,(function(e){e.userId===n.userId()&&s()})).on(L.RoomEvent.FORCEFULLY_LEFT,(function(e){e.userId===n.userId()&&s()})).on(L.RoomEvent.DROPPED,(function(e){e.userId===n.userId()&&s()})).on(L.RoomEvent.ENDED,s).on(L.RoomEvent.FAILED,s).on(L.RoomEvent.OPERATION_FAILED,(function(e){L.Operations.ROOM_JOIN===e.operation&&s()})),w.default.resolve(t[0].internalMessageId,n)}else if(t[0].type===L.SfuEvent.USER_ROOMS){const e=t[0];e.rooms.forEach((e=>{const t=new H.RoomExtended(M(this,r,"f"),e.id,e.owner,e.name,e.pin,this.user().username,this.user().nickname,e.creationTime,e.config,e.waitingRoomEnabled,M(this,f,"f"));M(this,c,"f")[t.id()]=t;const n=this,i=()=>{n.closePcAndFireEvent(t),delete M(n,c,"f")[t.id()]};t.on(L.RoomEvent.LEFT,(function(e){e.userId===t.userId()&&i()})).on(L.RoomEvent.EVICTED,(function(e){e.userId===t.userId()&&i()})).on(L.RoomEvent.FORCEFULLY_LEFT,(function(e){e.userId===t.userId()&&i()})).on(L.RoomEvent.DROPPED,(function(e){e.userId===t.userId()&&i()})).on(L.RoomEvent.ENDED,i).on(L.RoomEvent.FAILED,i).on(L.RoomEvent.OPERATION_FAILED,(function(e){L.Operations.ROOM_JOIN===e.operation&&i()}))})),w.default.resolve(t[0].internalMessageId,e.rooms)}else if(t[0].type===L.RoomEvent.OPERATION_FAILED&&w.default.promised(t[0].internalMessageId)){if(w.default.reject(t[0].internalMessageId,t[0]),t[0].roomId&&t[0].roomId.length>0){const e=M(this,c,"f")[t[0].roomId];e&&e.processEvent(t[0])}}else if(t[0].type===L.SfuEvent.ACK&&w.default.promised(t[0].internalMessageId))w.default.resolve(t[0].internalMessageId);else if(t[0].roomId&&t[0].roomId.length>0){const e=M(this,c,"f")[t[0].roomId];e&&e.processEvent(t[0])}else if(t[0].type===L.SfuEvent.USER_INFO){const e=t[0];w.default.resolve(e.internalMessageId,e.userInfo),M(this,_,"f").notify(L.SfuEvent.USER_INFO,e.userInfo)}else if(t[0].type===L.SfuEvent.USER_INFO_CHANGED){const e=t[0];M(this,s,"f").username===e.userId&&(M(this,s,"f").email=e.info.email,M(this,s,"f").nickname=e.info.nickname),w.default.resolve(e.internalMessageId)||M(this,_,"f").notify(L.SfuEvent.USER_INFO_CHANGED,e)}else if(t[0].type===L.SfuEvent.CHAT_MESSAGE_EDITED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.CHAT_MESSAGE_EDITED,e)}else if(t[0].type===L.SfuEvent.CHAT_MESSAGE_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.CHAT_MESSAGE_DELETED,e)}else if(t[0].type===L.SfuEvent.REACTION_ON_MESSAGE_ADDED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.REACTION_ON_MESSAGE_ADDED,e)}else if(t[0].type===L.SfuEvent.REACTION_ON_MESSAGE_REMOVED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.REACTION_ON_MESSAGE_REMOVED,e)}else if(t[0].type===L.SfuEvent.CHAT_MESSAGES_COUNT){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.CHAT_MESSAGES_COUNT,e)}else if(t[0].type===L.SfuEvent.FIRST_AND_LAST_CHAT_MESSAGE){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.FIRST_AND_LAST_CHAT_MESSAGE,e)}else if(t[0].type===L.SfuEvent.UNREAD_MESSAGES_COUNT){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.UNREAD_MESSAGES_COUNT,e)}else if(t[0].type===L.SfuEvent.UNREAD_MESSAGES_COUNT_UPDATE){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.UNREAD_MESSAGES_COUNT_UPDATE,e)}else if(t[0].type===L.SfuEvent.MESSAGE_ATTACHMENTS_SEARCH_RESULT){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.MESSAGE_ATTACHMENTS_SEARCH_RESULT,e)}else if(t[0].type===L.SfuEvent.LOAD_MESSAGES_WITH_MENTIONS_RESULT){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.LOAD_MESSAGES_WITH_MENTIONS_RESULT,e)}else if(t[0].type===L.SfuEvent.SEND_MESSAGE_SYNC){const e=t[0].message;M(this,_,"f").notify(L.SfuEvent.SEND_MESSAGE_SYNC,e)}else if(t[0].type===L.SfuEvent.AUTHENTICATION_STATUS){const e=t[0];M(this,_,"f").notify(L.SfuEvent.AUTHENTICATION_STATUS,e)}else if(t[0].type===L.SpaceEvent.SPACE_CREATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e.space)||M(this,_,"f").notify(L.SpaceEvent.SPACE_CREATED,e)}else if(t[0].type===L.SpaceEvent.NEW_SPACE){const e=t[0];w.default.resolve(t[0].internalMessageId,e.space),M(this,_,"f").notify(L.SpaceEvent.NEW_SPACE,e)}else if(t[0].type===L.SpaceEvent.SPACE_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e.id)||M(this,_,"f").notify(L.SpaceEvent.SPACE_DELETED,e)}else if(t[0].type===L.SpaceEvent.SPACE_OVERVIEW_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_OVERVIEW_UPDATED,e)}else if(t[0].type===L.SpaceEvent.NEW_SPACE_CATEGORY){const e=t[0];w.default.resolve(t[0].internalMessageId,e.category)||M(this,_,"f").notify(L.SpaceEvent.NEW_SPACE_CATEGORY,e)}else if(t[0].type===L.SpaceEvent.SPACE_CATEGORY_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_CATEGORY_DELETED,e)}else if(t[0].type===L.SpaceEvent.SPACE_CATEGORY_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_CATEGORY_UPDATED,e)}else if(t[0].type===L.SpaceEvent.NEW_SPACE_CHANNEL){const e=t[0];w.default.resolve(t[0].internalMessageId,e.channel)||M(this,_,"f").notify(L.SpaceEvent.NEW_SPACE_CHANNEL,e)}else if(t[0].type===L.SpaceEvent.SPACE_CHANNEL_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_CHANNEL_UPDATED,e)}else if(t[0].type===L.SpaceEvent.SPACE_CHANNEL_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_CHANNEL_DELETED,e)}else if(t[0].type===L.SpaceEvent.SPACE_CHANNEL_MOVED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_CHANNEL_MOVED,e)}else if(t[0].type===L.SpaceEvent.NEW_SPACE_THREAD){const e=t[0];w.default.resolve(t[0].internalMessageId,e.thread)||M(this,_,"f").notify(L.SpaceEvent.NEW_SPACE_THREAD,e)}else if(t[0].type===L.SpaceEvent.SPACE_THREAD_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_THREAD_UPDATED,e)}else if(t[0].type===L.SpaceEvent.ADDED_MEMBERS_TO_THREAD){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.ADDED_MEMBERS_TO_THREAD,e)}else if(t[0].type===L.SpaceEvent.REMOVED_MEMBER_FROM_THREAD){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.REMOVED_MEMBER_FROM_THREAD,e)}else if(t[0].type===L.SpaceEvent.SPACE_THREAD_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_THREAD_DELETED,e)}else if(t[0].type===L.SpaceEvent.SPACE_INVITE_CREATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e.invite)||M(this,_,"f").notify(L.SpaceEvent.SPACE_INVITE_CREATED,e)}else if(t[0].type===L.SpaceEvent.SPACE_INVITE_REVOKED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_INVITE_REVOKED,e)}else if(t[0].type===L.SpaceEvent.NEW_SPACE_ROLE){const e=t[0];w.default.resolve(t[0].internalMessageId,e.role)||M(this,_,"f").notify(L.SpaceEvent.NEW_SPACE_ROLE,e)}else if(t[0].type===L.SpaceEvent.SPACE_ROLE_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_ROLE_UPDATED,e)}else if(t[0].type===L.SpaceEvent.SPACE_ROLE_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_ROLE_DELETED,e)}else if(t[0].type===L.SpaceEvent.ADDED_ROLE_TO_MEMBER){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.ADDED_ROLE_TO_MEMBER,e)}else if(t[0].type===L.SpaceEvent.REMOVED_ROLE_FROM_MEMBER){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.REMOVED_ROLE_FROM_MEMBER,e)}else if(t[0].type===L.SpaceEvent.USER_SPACES){const e=t[0];w.default.resolve(t[0].internalMessageId,e.spaces),M(this,_,"f").notify(L.SpaceEvent.USER_SPACES,e.spaces)}else if(t[0].type===L.SpaceEvent.USER_JOINED_TO_SPACE){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.USER_JOINED_TO_SPACE,e)}else if(t[0].type===L.SpaceEvent.USER_LEFT_SPACE){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.USER_LEFT_SPACE,e)}else if(t[0].type===L.SpaceEvent.ROLE_PERMISSION_SECTIONS){const e=t[0];w.default.resolve(t[0].internalMessageId,e.permissionSections)||M(this,_,"f").notify(L.SpaceEvent.ROLE_PERMISSION_SECTIONS,e)}else if(t[0].type===L.SpaceEvent.USER_SPACE_NICKNAME_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.USER_SPACE_NICKNAME_UPDATED,e)}else if(t[0].type===L.SpaceEvent.SPACE_NOTIFICATION_SETTINGS_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_NOTIFICATION_SETTINGS_UPDATED,e)}else if(t[0].type===L.SpaceEvent.CHANNEL_NOTIFICATION_SETTINGS_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.CHANNEL_NOTIFICATION_SETTINGS_UPDATED,e)}else if(t[0].type===L.SpaceEvent.THREAD_NOTIFICATION_SETTINGS_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.THREAD_NOTIFICATION_SETTINGS_UPDATED,e)}else if(t[0].type===L.SpaceEvent.SPACE_MUTED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_MUTED,e)}else if(t[0].type===L.SpaceEvent.SPACE_UNMUTED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.SPACE_UNMUTED,e)}else if(t[0].type===L.SpaceEvent.CHANNEL_MUTED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.CHANNEL_MUTED,e)}else if(t[0].type===L.SpaceEvent.CHANNEL_UNMUTED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.CHANNEL_UNMUTED,e)}else if(t[0].type===L.SpaceEvent.THREAD_MUTED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.THREAD_MUTED,e)}else if(t[0].type===L.SpaceEvent.THREAD_UNMUTED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SpaceEvent.THREAD_UNMUTED,e)}else if(t[0].type===L.SfuEvent.USER_MEETINGS){const e=t[0];M(this,_,"f").notify(L.SfuEvent.USER_MEETINGS,e)}else if(t[0].type===L.SfuEvent.NEW_MEETING){const e=t[0];M(this,_,"f").notify(L.SfuEvent.NEW_MEETING,e)}else if(t[0].type===L.MeetingSyncEvent.MEETING_ENDED_SYNC){const e=t[0];M(this,_,"f").notify(L.MeetingSyncEvent.MEETING_ENDED_SYNC,e)}else if(t[0].type===L.MeetingSyncEvent.JOINED_MEETING_SYNC){const e=t[0];M(this,_,"f").notify(L.MeetingSyncEvent.JOINED_MEETING_SYNC,e)}else if(t[0].type===L.MeetingSyncEvent.LEFT_MEETING_SYNC){const e=t[0];M(this,_,"f").notify(L.MeetingSyncEvent.LEFT_MEETING_SYNC,e)}else if(t[0].type===L.MeetingSyncEvent.EVICTED_SYNC){const e=t[0];M(this,_,"f").notify(L.MeetingSyncEvent.EVICTED_SYNC,e)}else if(t[0].type===L.MeetingSyncEvent.ADD_TRACKS_SYNC){const e=t[0];M(this,_,"f").notify(L.MeetingSyncEvent.ADD_TRACKS_SYNC,e)}else if(t[0].type===L.MeetingSyncEvent.REMOVE_TRACKS_SYNC){const e=t[0];M(this,_,"f").notify(L.MeetingSyncEvent.REMOVE_TRACKS_SYNC,e)}else if(t[0].type===L.MeetingSyncEvent.MUTE_TRACKS_SYNC){const e=t[0];M(this,_,"f").notify(L.MeetingSyncEvent.MUTE_TRACKS_SYNC,e)}else if(t[0].type===L.MeetingSyncEvent.PARTICIPANT_LIST_SYNC){const e=t[0];M(this,_,"f").notify(L.MeetingSyncEvent.PARTICIPANT_LIST_SYNC,e)}else if(t[0].type===L.MeetingSyncEvent.MEETING_NAME_UPDATED_SYNC){const e=t[0];M(this,_,"f").notify(L.MeetingSyncEvent.MEETING_NAME_UPDATED_SYNC,e)}else if(t[0].type===L.SfuEvent.USER_CONTACTS){const e=t[0];w.default.resolve(t[0].internalMessageId,e.contacts)||M(this,_,"f").notify(L.SfuEvent.USER_CONTACTS,e)}else if(t[0].type===L.SfuEvent.NEW_CONTACT){const e=t[0];w.default.resolve(t[0].internalMessageId,e.contact)||M(this,_,"f").notify(L.SfuEvent.NEW_CONTACT,e)}else if(t[0].type===L.SfuEvent.CONTACT_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e.contact)||M(this,_,"f").notify(L.SfuEvent.CONTACT_UPDATED,e)}else if(t[0].type===L.SfuEvent.CONTACT_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.CONTACT_DELETED,e)}else if(t[0].type===L.SfuEvent.NEW_INCOMING_FRIEND_INVITE){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.NEW_INCOMING_FRIEND_INVITE,e)}else if(t[0].type===L.SfuEvent.NEW_OUTGOING_FRIEND_INVITE){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.NEW_OUTGOING_FRIEND_INVITE,e)}else if(t[0].type===L.SfuEvent.INCOMING_FRIEND_INVITE_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.INCOMING_FRIEND_INVITE_DELETED,e)}else if(t[0].type===L.SfuEvent.OUTGOING_FRIEND_INVITE_DELETED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.OUTGOING_FRIEND_INVITE_DELETED,e)}else if(t[0].type===L.SfuEvent.USER_PRESENCE_STATUS_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e)||M(this,_,"f").notify(L.SfuEvent.USER_PRESENCE_STATUS_UPDATED,e)}else if(t[0].type===L.SfuEvent.USER_ENCRYPTION_INFO_ADDED){const e=t[0];w.default.resolve(t[0].internalMessageId,e.info)||M(this,_,"f").notify(L.SfuEvent.USER_ENCRYPTION_INFO_ADDED,e)}else if(t[0].type===L.SfuEvent.USER_ENCRYPTION_INFO){const e=t[0];w.default.resolve(t[0].internalMessageId,e.info)}else if(t[0].type===L.SfuEvent.CONTACT_PERSONAL_SETTINGS_UPDATED){const e=t[0];w.default.resolve(t[0].internalMessageId,e.personalSettings)||M(this,_,"f").notify(L.SfuEvent.CONTACT_PERSONAL_SETTINGS_UPDATED,e)}else M(this,_,"f").notify(t[0].type,t[0]);break;case"failed":M(this,_,"f").notify(L.SfuEvent.FAILED,t[0])}}),(()=>{}),(t=>{y(e,E,L.State.FAILED,"f"),M(e,_,"f").notify(L.SfuEvent.CONNECTION_FAILED,t)}),(t=>{y(e,E,L.State.DISCONNECTED,"f"),e.disconnect(),y(e,l,{},"f");const n={reason:t.reason,code:t.code,type:L.SfuEvent.DISCONNECTED,roomId:"",internalMessageId:""};"Normal disconnect"===t.reason?M(e,_,"f").notify(L.SfuEvent.DISCONNECTED,n):(n.type=L.SfuEvent.CONNECTION_FAILED,M(e,_,"f").notify(L.SfuEvent.CONNECTION_FAILED,n))}),M(this,T,"f")),"f")},p=function(e,t){return{url:e,appName:L.InternalApi.Z_USER_MANAGEMENT_APP,timeout:t||1e4,custom:{username:"",password:"",nickname:""}}},C=function(e,t){return{url:e,appName:L.InternalApi.Z_EXAMPLES_MANAGEMENT_APP,timeout:t||1e4,custom:{username:"",password:"",nickname:""}}}},406:function(e,t,n){var i,r,s,a,o,E,c,_,l=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&l(t,e,n);return d(t,e),t},T=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))},f=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},A=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n};Object.defineProperty(t,"__esModule",{value:!0}),t.Sfu=void 0;const S=n(796),h=n(494),I=n(980),N=n(876),R=u(n(163));t.Sfu=class{constructor(e,t){i.set(this,void 0),r.set(this,void 0),s.set(this,void 0),a.set(this,h.State.NEW),o.set(this,void 0),E.set(this,new I.Notifier),c.set(this,new R.default),_.set(this,void 0),f(this,c,"f").setVerbosity(e||R.Verbosity.ERROR),t&&(A(this,_,t,"f"),f(this,c,"f").setPrefix(t)),f(this,c,"f").setVerbosity(e||R.Verbosity.ERROR)}connect(e){if(!e)throw new TypeError("No options provided");A(this,r,e.url,"f"),A(this,s,e.nickname,"f");const t={url:e.url,appName:h.InternalApi.P_APP,timeout:e.timeout,failedProbesThreshold:e.failedProbesThreshold,pingInterval:e.pingInterval,custom:{nickname:e.nickname,roomName:e.logGroup}},n=this;return new Promise(((e,r)=>T(this,void 0,void 0,(function*(){A(n,i,new S.Connection(((e,t)=>{switch(f(this,c,"f").debug("onMessage: ",t[0]),e){case h.InternalApi.DEFAULT_METHOD:t[0].roomId&&t[0].roomId.length>0?f(this,o,"f")&&f(this,o,"f").processEvent(t[0]):f(this,E,"f").notify(t[0].type,t[0]);break;case"failed":f(this,E,"f").notify(h.SfuEvent.FAILED,t[0])}}),(()=>{}),(e=>{A(n,a,h.State.FAILED,"f"),f(n,E,"f").notify(h.SfuEvent.FAILED,e),r(e)}),(()=>{A(n,a,h.State.DISCONNECTED,"f"),f(n,E,"f").notify(h.SfuEvent.DISCONNECTED)}),f(this,c,"f")),"f");try{yield f(this,i,"f").connect(t),A(n,a,h.State.CONNECTED,"f"),f(this,E,"f").notify(h.SfuEvent.CONNECTED),e()}catch(e){A(n,a,h.State.FAILED,"f"),f(this,E,"f").notify(h.SfuEvent.FAILED,e),r(e)}}))))}createRoom(e){if(f(this,o,"f"))switch(f(this,o,"f").state()){case h.RoomState.NEW:case h.RoomState.JOINED:case h.RoomState.PENDING:throw new Error("Only one room at a time, already have one with state "+f(this,o,"f").state());case h.RoomState.FAILED:case h.RoomState.DISPOSED:A(this,o,new N.Room(f(this,i,"f"),e.name,e.pin,f(this,s,"f"),Date.now()),"f");break;default:throw new Error("Unknown room state "+f(this,o,"f").state())}else A(this,o,new N.Room(f(this,i,"f"),e.name,e.pin,f(this,s,"f"),Date.now()),"f");return f(this,o,"f")}disconnect(){return T(this,void 0,void 0,(function*(){f(this,o,"f")&&f(this,o,"f").state()===h.RoomState.JOINED&&(yield f(this,o,"f").leaveRoom()),f(this,i,"f")&&(yield f(this,i,"f").close())}))}room(){return f(this,o,"f")}nickname(){return f(this,s,"f")}state(){return f(this,a,"f")}on(e,t){return f(this,E,"f").add(e,t),this}off(e,t){return f(this,E,"f").remove(e,t),this}},i=new WeakMap,r=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,E=new WeakMap,c=new WeakMap,_=new WeakMap},137:function(e,t,n){var i,r,s,a,o,E,c=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))},_=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRTCStats=void 0;const d=l(n(163)),u=n(494);t.WebRTCStats=class{constructor(e){i.add(this),this.pc=e,this.logger=new d.default,this.tracks={}}getStats(e,t,n){return c(this,void 0,void 0,(function*(){let s={};if(!e)throw new Error("Can't get statistics for track "+e);this.tracks[e.id]||(this.tracks[e.id]={track:e,type:t,bytesCount:0,seconds:Math.round((new Date).getTime()/1e3)});let a=yield this.pc.getStats(e);a&&a.forEach((n=>{n.isRemote||n.type==t&&(s=_(this,i,"m",r).call(this,e.id,n))})),n(s)}))}},i=new WeakSet,r=function(e,t){let n={},r=_(this,i,"m",a).call(this,t.mediaType),s=_(this,i,"m",E).call(this,e,t);return n.codec=r.name,n.sampleRate=r.sampleRate,s>-1&&(n.bitrate=s),Object.keys(t).forEach((e=>{n[e]=t[e]})),n},s=function(){let e=null!=this.pc.currentRemoteDescription?this.pc.currentRemoteDescription:this.pc.remoteDescription,t="";return e&&e.sdp&&(t=e.sdp),t},a=function(e){let t,n=_(this,i,"m",s).call(this).split("\n"),r={name:"undefined",sampleRate:"undefined"};for(let i=0;i<n.length;i++){if(t&&-1!=n[i].indexOf("a=rtpmap:"+t))return r.name=n[i].split(" ")[1].split("/")[0],r.sampleRate=n[i].split(" ")[1].split("/")[1],r;-1!=n[i].indexOf("m="+e)&&(t=n[i].split(" ")[3].trim())}return r},o=function(e,t){let n=0;return e==u.StatsType.INBOUND?n=t.bytesReceived:e==u.StatsType.OUTBOUND&&(n=t.bytesSent),n},E=function(e,t){let n=-1;if(this.tracks[e]){let r=_(this,i,"m",o).call(this,this.tracks[e].type,t),s=Math.round((new Date).getTime()/1e3),a=s-this.tracks[e].seconds;a>0&&(n=8*(r-this.tracks[e].bytesCount)/a),this.tracks[e].bytesCount=r,this.tracks[e].seconds=s}return n}},78:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var i=n(582),r=n(403),s=function(){function e(e){this._semaphore=new r.default(1,e)}return e.prototype.acquire=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return[4,this._semaphore.acquire()];case 1:return[2,e.sent()[1]]}}))}))},e.prototype.runExclusive=function(e){return this._semaphore.runExclusive((function(){return e()}))},e.prototype.isLocked=function(){return this._semaphore.isLocked()},e.prototype.waitForUnlock=function(){return this._semaphore.waitForUnlock()},e.prototype.release=function(){this._semaphore.isLocked()&&this._semaphore.release()},e.prototype.cancel=function(){return this._semaphore.cancel()},e}();t.default=s},403:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var i=n(582),r=n(764),s=function(){function e(e,t){void 0===t&&(t=r.E_CANCELED),this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}return e.prototype.acquire=function(e){var t=this;if(void 0===e&&(e=1),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));return new Promise((function(n,i){t._weightedQueues[e-1]||(t._weightedQueues[e-1]=[]),t._weightedQueues[e-1].push({resolve:n,reject:i}),t._dispatch()}))},e.prototype.runExclusive=function(e,t){return void 0===t&&(t=1),i.__awaiter(this,void 0,void 0,(function(){var n,r,s;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.acquire(t)];case 1:n=i.sent(),r=n[0],s=n[1],i.label=2;case 2:return i.trys.push([2,,4,5]),[4,e(r)];case 3:return[2,i.sent()];case 4:return s(),[7];case 5:return[2]}}))}))},e.prototype.waitForUnlock=function(e){var t=this;if(void 0===e&&(e=1),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));return new Promise((function(n){t._weightedWaiters[e-1]||(t._weightedWaiters[e-1]=[]),t._weightedWaiters[e-1].push(n),t._dispatch()}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(e){this._value=e,this._dispatch()},e.prototype.release=function(e){if(void 0===e&&(e=1),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));this._value+=e,this._dispatch()},e.prototype.cancel=function(){var e=this;this._weightedQueues.forEach((function(t){return t.forEach((function(t){return t.reject(e._cancelError)}))})),this._weightedQueues=[]},e.prototype._dispatch=function(){for(var e,t=this._value;t>0;t--){var n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(n){var i=this._value,r=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(r)])}}this._drainUnlockWaiters()},e.prototype._newReleaser=function(e){var t=this,n=!1;return function(){n||(n=!0,t.release(e))}},e.prototype._drainUnlockWaiters=function(){for(var e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach((function(e){return e()})),this._weightedWaiters[e-1]=[])},e}();t.default=s},764:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.E_CANCELED=t.E_ALREADY_LOCKED=t.E_TIMEOUT=void 0,t.E_TIMEOUT=new Error("timeout while waiting for mutex to become available"),t.E_ALREADY_LOCKED=new Error("mutex already locked"),t.E_CANCELED=new Error("request for lock canceled")},125:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tryAcquire=t.withTimeout=t.Semaphore=t.Mutex=void 0;var i=n(582),r=n(78);Object.defineProperty(t,"Mutex",{enumerable:!0,get:function(){return r.default}});var s=n(403);Object.defineProperty(t,"Semaphore",{enumerable:!0,get:function(){return s.default}});var a=n(960);Object.defineProperty(t,"withTimeout",{enumerable:!0,get:function(){return a.withTimeout}});var o=n(143);Object.defineProperty(t,"tryAcquire",{enumerable:!0,get:function(){return o.tryAcquire}}),i.__exportStar(n(764),t)},143:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tryAcquire=void 0;var i=n(764),r=n(960);t.tryAcquire=function(e,t){return void 0===t&&(t=i.E_ALREADY_LOCKED),(0,r.withTimeout)(e,0,t)}},960:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.withTimeout=void 0;var i=n(582),r=n(764);t.withTimeout=function(e,t,n){var s=this;return void 0===n&&(n=r.E_TIMEOUT),{acquire:function(r){if(void 0!==r&&r<=0)throw new Error("invalid weight ".concat(r,": must be positive"));return new Promise((function(a,o){return i.__awaiter(s,void 0,void 0,(function(){var s,E,c,_;return i.__generator(this,(function(i){switch(i.label){case 0:s=!1,E=setTimeout((function(){s=!0,o(n)}),t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.acquire(r)];case 2:return c=i.sent(),s?(Array.isArray(c)?c[1]:c)():(clearTimeout(E),a(c)),[3,4];case 3:return _=i.sent(),s||(clearTimeout(E),o(_)),[3,4];case 4:return[2]}}))}))}))},runExclusive:function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var n,r;return i.__generator(this,(function(i){switch(i.label){case 0:n=function(){},i.label=1;case 1:return i.trys.push([1,,7,8]),[4,this.acquire(t)];case 2:return r=i.sent(),Array.isArray(r)?(n=r[1],[4,e(r[0])]):[3,4];case 3:return[2,i.sent()];case 4:return n=r,[4,e()];case 5:return[2,i.sent()];case 6:return[3,8];case 7:return n(),[7];case 8:return[2]}}))}))},release:function(t){e.release(t)},cancel:function(){return e.cancel()},waitForUnlock:function(i){if(void 0!==i&&i<=0)throw new Error("invalid weight ".concat(i,": must be positive"));return new Promise((function(r,s){var a=setTimeout((function(){return s(n)}),t);e.waitForUnlock(i).then((function(){clearTimeout(a),r()}))}))},isLocked:function(){return e.isLocked()},getValue:function(){return e.getValue()},setValue:function(t){return e.setValue(t)}}}},913:e=>{function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.R,r=void 0===i?1:i,s=n.Q,a=void 0===s?1:s,o=n.A,E=void 0===o?1:o,c=n.B,_=void 0===c?0:c,l=n.C,d=void 0===l?1:l;t(this,e),this.R=r,this.Q=a,this.A=E,this.C=d,this.B=_,this.cov=NaN,this.x=NaN}var i,r;return i=e,r=[{key:"filter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(isNaN(this.x))this.x=1/this.C*e,this.cov=1/this.C*this.Q*(1/this.C);else{var n=this.predict(t),i=this.uncertainty(),r=i*this.C*(1/(this.C*i*this.C+this.Q));this.x=n+r*(e-this.C*n),this.cov=i-r*this.C*i}return this.x}},{key:"predict",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.A*this.x+this.B*e}},{key:"uncertainty",value:function(){return this.A*this.cov*this.A+this.R}},{key:"lastMeasurement",value:function(){return this.x}},{key:"setMeasurementNoise",value:function(e){this.Q=e}},{key:"setProcessNoise",value:function(e){this.R=e}}],r&&n(i.prototype,r),e}();e.exports=i},329:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(...e){this._head=this._tail=null,this._length=0,e.length>0&&e.forEach((e=>{this.append(e)}))}*iterator(){let e=this._head;for(;e;)yield e.value,e=e.next}[Symbol.iterator](){return this.iterator()}get head(){return this._head?this._head.value:null}get tail(){return this._tail?this._tail.value:null}get length(){return this._length}insert(e,t,n=!1){if(n&&this.isDuplicate(e))return!1;let r=new i(e),s=this._head;if(!s)return!1;for(;;){if(s.value===t)return r.next=s.next,r.prev=s,s.next=r,r.next?r.next.prev=r:this._tail=r,this._length++,!0;if(!s.next)return!1;s=s.next}}append(e,t=!1){if(t&&this.isDuplicate(e))return!1;let n=new i(e);return this._tail?(this._tail.next=n,n.prev=this._tail,this._tail=n):this._head=this._tail=n,this._length++,!0}prepend(e,t=!1){if(t&&this.isDuplicate(e))return!1;let n=new i(e);return this._head?(n.next=this._head,this._head.prev=n,this._head=n):this._head=this._tail=n,this._length++,!0}remove(e){let t=this._head;if(t){if(t.value===e)return this._head=t.next,this._head.prev=null,t.next=t.prev=null,this._length--,t.value;for(;;){if(t.value===e)return t.next?(t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null):(t.prev.next=null,this._tail=t.prev,t.next=t.prev=null),this._length--,t.value;if(!t.next)return;t=t.next}}}removeHead(){let e=this._head;if(e)return this._head.next?(this._head.next.prev=null,this._head=this._head.next,e.next=e.prev=null):(this._head=null,this._tail=null),this._length--,e.value}removeTail(){let e=this._tail;if(e)return this._tail.prev?(this._tail.prev.next=null,this._tail=this._tail.prev,e.next=e.prev=null):(this._head=null,this._tail=null),this._length--,e.value}first(e){let t=this.iterator(),n=[],i=Math.min(e,this.length);for(let e=0;e<i;e++){let e=t.next();n.push(e.value)}return n}toArray(){return[...this]}isDuplicate(e){return new Set(this.toArray()).has(e)}}t.LinkedList=n;class i{constructor(e){this.value=e,this.next=null,this.prev=null}}t.LinkedListItem=i},17:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(329);class r extends i.LinkedList{constructor(...e){super(...e)}get front(){return this.head}enqueue(e){this.append(e)}dequeue(){return this.removeHead()}}t.Queue=r},378:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createFilter=t.constants=t.createRoom=void 0;const s=r(n(913)),a=n(201);t.createRoom=function(e){return i(this,void 0,void 0,(function*(){try{const t=new a.Sfu;return yield t.connect({url:e.url,nickname:e.nickname,logGroup:e.roomName,failedProbesThreshold:e.failedProbesThreshold,pingInterval:e.pingInterval}),t.createRoom({name:e.roomName,pin:e.pin}),t}catch(t){throw new Error("Can't connect to websocket URL "+e.url)}}))},t.constants={SFU_EVENT:a.SfuEvent,SFU_ROOM_EVENT:a.RoomEvent,SFU_STATE:a.State,SFU_RTC_STATS_TYPE:a.StatsType},t.createFilter=function(){return new s.default}},614:(e,t,n)=>{var i;n.r(t),n.d(t,{NIL:()=>P,parse:()=>A,stringify:()=>_,v1:()=>f,v3:()=>O,v4:()=>D,v5:()=>y,validate:()=>o,version:()=>g});var r=new Uint8Array(16);function s(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)}const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,o=function(e){return"string"==typeof e&&a.test(e)};for(var E=[],c=0;c<256;++c)E.push((c+256).toString(16).substr(1));const _=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(E[e[t+0]]+E[e[t+1]]+E[e[t+2]]+E[e[t+3]]+"-"+E[e[t+4]]+E[e[t+5]]+"-"+E[e[t+6]]+E[e[t+7]]+"-"+E[e[t+8]]+E[e[t+9]]+"-"+E[e[t+10]]+E[e[t+11]]+E[e[t+12]]+E[e[t+13]]+E[e[t+14]]+E[e[t+15]]).toLowerCase();if(!o(n))throw TypeError("Stringified UUID is invalid");return n};var l,d,u=0,T=0;const f=function(e,t,n){var i=t&&n||0,r=t||new Array(16),a=(e=e||{}).node||l,o=void 0!==e.clockseq?e.clockseq:d;if(null==a||null==o){var E=e.random||(e.rng||s)();null==a&&(a=l=[1|E[0],E[1],E[2],E[3],E[4],E[5]]),null==o&&(o=d=16383&(E[6]<<8|E[7]))}var c=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:T+1,A=c-u+(f-T)/1e4;if(A<0&&void 0===e.clockseq&&(o=o+1&16383),(A<0||c>u)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=c,T=f,d=o;var S=(1e4*(268435455&(c+=122192928e5))+f)%4294967296;r[i++]=S>>>24&255,r[i++]=S>>>16&255,r[i++]=S>>>8&255,r[i++]=255&S;var h=c/4294967296*1e4&268435455;r[i++]=h>>>8&255,r[i++]=255&h,r[i++]=h>>>24&15|16,r[i++]=h>>>16&255,r[i++]=o>>>8|128,r[i++]=255&o;for(var I=0;I<6;++I)r[i+I]=a[I];return t||_(r)},A=function(e){if(!o(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};function S(e,t,n){function i(e,i,r,s){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof i&&(i=A(i)),16!==i.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+e.length);if(a.set(i),a.set(e,i.length),(a=n(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,r){s=s||0;for(var o=0;o<16;++o)r[s+o]=a[o];return r}return _(a)}try{i.name=e}catch(e){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}function h(e){return 14+(e+64>>>9<<4)+1}function I(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function N(e,t,n,i,r,s){return I((a=I(I(t,e),I(i,s)))<<(o=r)|a>>>32-o,n);var a,o}function R(e,t,n,i,r,s,a){return N(t&n|~t&i,e,t,r,s,a)}function p(e,t,n,i,r,s,a){return N(t&i|n&~i,e,t,r,s,a)}function C(e,t,n,i,r,s,a){return N(t^n^i,e,t,r,s,a)}function m(e,t,n,i,r,s,a){return N(n^(t|~i),e,t,r,s,a)}const O=S("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,i="0123456789abcdef",r=0;r<n;r+=8){var s=e[r>>5]>>>r%32&255,a=parseInt(i.charAt(s>>>4&15)+i.charAt(15&s),16);t.push(a)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[h(t)-1]=t;for(var n=1732584193,i=-271733879,r=-1732584194,s=271733878,a=0;a<e.length;a+=16){var o=n,E=i,c=r,_=s;n=R(n,i,r,s,e[a],7,-680876936),s=R(s,n,i,r,e[a+1],12,-389564586),r=R(r,s,n,i,e[a+2],17,606105819),i=R(i,r,s,n,e[a+3],22,-1044525330),n=R(n,i,r,s,e[a+4],7,-176418897),s=R(s,n,i,r,e[a+5],12,1200080426),r=R(r,s,n,i,e[a+6],17,-1473231341),i=R(i,r,s,n,e[a+7],22,-45705983),n=R(n,i,r,s,e[a+8],7,1770035416),s=R(s,n,i,r,e[a+9],12,-1958414417),r=R(r,s,n,i,e[a+10],17,-42063),i=R(i,r,s,n,e[a+11],22,-1990404162),n=R(n,i,r,s,e[a+12],7,1804603682),s=R(s,n,i,r,e[a+13],12,-40341101),r=R(r,s,n,i,e[a+14],17,-1502002290),n=p(n,i=R(i,r,s,n,e[a+15],22,1236535329),r,s,e[a+1],5,-165796510),s=p(s,n,i,r,e[a+6],9,-1069501632),r=p(r,s,n,i,e[a+11],14,643717713),i=p(i,r,s,n,e[a],20,-373897302),n=p(n,i,r,s,e[a+5],5,-701558691),s=p(s,n,i,r,e[a+10],9,38016083),r=p(r,s,n,i,e[a+15],14,-660478335),i=p(i,r,s,n,e[a+4],20,-405537848),n=p(n,i,r,s,e[a+9],5,568446438),s=p(s,n,i,r,e[a+14],9,-1019803690),r=p(r,s,n,i,e[a+3],14,-187363961),i=p(i,r,s,n,e[a+8],20,1163531501),n=p(n,i,r,s,e[a+13],5,-1444681467),s=p(s,n,i,r,e[a+2],9,-51403784),r=p(r,s,n,i,e[a+7],14,1735328473),n=C(n,i=p(i,r,s,n,e[a+12],20,-1926607734),r,s,e[a+5],4,-378558),s=C(s,n,i,r,e[a+8],11,-2022574463),r=C(r,s,n,i,e[a+11],16,1839030562),i=C(i,r,s,n,e[a+14],23,-35309556),n=C(n,i,r,s,e[a+1],4,-1530992060),s=C(s,n,i,r,e[a+4],11,1272893353),r=C(r,s,n,i,e[a+7],16,-155497632),i=C(i,r,s,n,e[a+10],23,-1094730640),n=C(n,i,r,s,e[a+13],4,681279174),s=C(s,n,i,r,e[a],11,-358537222),r=C(r,s,n,i,e[a+3],16,-722521979),i=C(i,r,s,n,e[a+6],23,76029189),n=C(n,i,r,s,e[a+9],4,-640364487),s=C(s,n,i,r,e[a+12],11,-421815835),r=C(r,s,n,i,e[a+15],16,530742520),n=m(n,i=C(i,r,s,n,e[a+2],23,-995338651),r,s,e[a],6,-198630844),s=m(s,n,i,r,e[a+7],10,1126891415),r=m(r,s,n,i,e[a+14],15,-1416354905),i=m(i,r,s,n,e[a+5],21,-57434055),n=m(n,i,r,s,e[a+12],6,1700485571),s=m(s,n,i,r,e[a+3],10,-1894986606),r=m(r,s,n,i,e[a+10],15,-1051523),i=m(i,r,s,n,e[a+1],21,-2054922799),n=m(n,i,r,s,e[a+8],6,1873313359),s=m(s,n,i,r,e[a+15],10,-30611744),r=m(r,s,n,i,e[a+6],15,-1560198380),i=m(i,r,s,n,e[a+13],21,1309151649),n=m(n,i,r,s,e[a+4],6,-145523070),s=m(s,n,i,r,e[a+11],10,-1120210379),r=m(r,s,n,i,e[a+2],15,718787259),i=m(i,r,s,n,e[a+9],21,-343485551),n=I(n,o),i=I(i,E),r=I(r,c),s=I(s,_)}return[n,i,r,s]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(h(t)),i=0;i<t;i+=8)n[i>>5]|=(255&e[i/8])<<i%32;return n}(e),8*e.length))})),D=function(e,t,n){var i=(e=e||{}).random||(e.rng||s)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return _(i)};function v(e,t,n,i){switch(e){case 0:return t&n^~t&i;case 1:case 3:return t^n^i;case 2:return t&n^t&i^n&i}}function M(e,t){return e<<t|e>>>32-t}const y=S("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var i=unescape(encodeURIComponent(e));e=[];for(var r=0;r<i.length;++r)e.push(i.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var s=e.length/4+2,a=Math.ceil(s/16),o=new Array(a),E=0;E<a;++E){for(var c=new Uint32Array(16),_=0;_<16;++_)c[_]=e[64*E+4*_]<<24|e[64*E+4*_+1]<<16|e[64*E+4*_+2]<<8|e[64*E+4*_+3];o[E]=c}o[a-1][14]=8*(e.length-1)/Math.pow(2,32),o[a-1][14]=Math.floor(o[a-1][14]),o[a-1][15]=8*(e.length-1)&4294967295;for(var l=0;l<a;++l){for(var d=new Uint32Array(80),u=0;u<16;++u)d[u]=o[l][u];for(var T=16;T<80;++T)d[T]=M(d[T-3]^d[T-8]^d[T-14]^d[T-16],1);for(var f=n[0],A=n[1],S=n[2],h=n[3],I=n[4],N=0;N<80;++N){var R=Math.floor(N/20),p=M(f,5)+v(R,A,S,h)+I+t[R]+d[N]>>>0;I=h,h=S,S=M(A,30)>>>0,A=f,f=p}n[0]=n[0]+f>>>0,n[1]=n[1]+A>>>0,n[2]=n[2]+S>>>0,n[3]=n[3]+h>>>0,n[4]=n[4]+I>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),P="00000000-0000-0000-0000-000000000000",g=function(e){if(!o(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},582:(e,t,n)=>{n.r(t),n.d(t,{__addDisposableResource:()=>G,__assign:()=>s,__asyncDelegator:()=>O,__asyncGenerator:()=>m,__asyncValues:()=>D,__await:()=>C,__awaiter:()=>T,__classPrivateFieldGet:()=>w,__classPrivateFieldIn:()=>L,__classPrivateFieldSet:()=>U,__createBinding:()=>A,__decorate:()=>o,__disposeResources:()=>b,__esDecorate:()=>c,__exportStar:()=>S,__extends:()=>r,__generator:()=>f,__importDefault:()=>g,__importStar:()=>P,__makeTemplateObject:()=>v,__metadata:()=>u,__param:()=>E,__propKey:()=>l,__read:()=>I,__rest:()=>a,__rewriteRelativeImportExtension:()=>F,__runInitializers:()=>_,__setFunctionName:()=>d,__spread:()=>N,__spreadArray:()=>p,__spreadArrays:()=>R,__values:()=>h,default:()=>V});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s.apply(this,arguments)};function a(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function o(e,t,n,i){var r,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,n,a):r(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a}function E(e,t){return function(n,i){t(n,i,e)}}function c(e,t,n,i,r,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,E=i.kind,c="getter"===E?"get":"setter"===E?"set":"value",_=!t&&e?i.static?e:e.prototype:null,l=t||(_?Object.getOwnPropertyDescriptor(_,i.name):{}),d=!1,u=n.length-1;u>=0;u--){var T={};for(var f in i)T[f]="access"===f?{}:i[f];for(var f in i.access)T.access[f]=i.access[f];T.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var A=(0,n[u])("accessor"===E?{get:l.get,set:l.set}:l[c],T);if("accessor"===E){if(void 0===A)continue;if(null===A||"object"!=typeof A)throw new TypeError("Object expected");(o=a(A.get))&&(l.get=o),(o=a(A.set))&&(l.set=o),(o=a(A.init))&&r.unshift(o)}else(o=a(A))&&("field"===E?r.unshift(o):l[c]=o)}_&&Object.defineProperty(_,i.name,l),d=!0}function _(e,t,n){for(var i=arguments.length>2,r=0;r<t.length;r++)n=i?t[r].call(e,n):t[r].call(e);return i?n:void 0}function l(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function T(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{E(i.next(e))}catch(e){s(e)}}function o(e){try{E(i.throw(e))}catch(e){s(e)}}function E(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}E((i=i.apply(e,t||[])).next())}))}function f(e,t){var n,i,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(E){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,E])}}}var A=Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]};function S(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||A(t,e,n)}function h(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}function N(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(I(arguments[t]));return e}function R(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,r++)i[r]=s[a];return i}function p(e,t,n){if(n||2===arguments.length)for(var i,r=0,s=t.length;r<s;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function C(e){return this instanceof C?(this.v=e,this):new C(e)}function m(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),s=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),i[Symbol.asyncIterator]=function(){return this},i;function a(e,t){r[e]&&(i[e]=function(t){return new Promise((function(n,i){s.push([e,t,n,i])>1||o(e,t)}))},t&&(i[e]=t(i[e])))}function o(e,t){try{(n=r[e](t)).value instanceof C?Promise.resolve(n.value.v).then(E,c):_(s[0][2],n)}catch(e){_(s[0][3],e)}var n}function E(e){o("next",e)}function c(e){o("throw",e)}function _(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}}function O(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:C(e[i](t)),done:!1}:r?r(t):t}:r}}function D(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=h(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,r,(t=e[n](t)).done,t.value)}))}}}function v(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var M=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},y=function(e){return y=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},y(e)};function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=y(e),i=0;i<n.length;i++)"default"!==n[i]&&A(t,e,n[i]);return M(t,e),t}function g(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function U(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n}function L(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function G(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],n&&(r=i)}if("function"!=typeof i)throw new TypeError("Object not disposable.");r&&(i=function(){try{r.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:i,async:n})}else n&&e.stack.push({async:!0});return t}var H="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var i=new Error(n);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function b(e){function t(t){e.error=e.hasError?new H(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var n,i=0;return function r(){for(;n=e.stack.pop();)try{if(!n.async&&1===i)return i=0,e.stack.push(n),Promise.resolve().then(r);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return i|=2,Promise.resolve(s).then(r,(function(e){return t(e),r()}))}else i|=1}catch(e){t(e)}if(1===i)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function F(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(e,n,i,r,s){return n?t?".jsx":".js":!i||r&&s?i+r+"."+s.toLowerCase()+"js":e})):e}const V={__extends:r,__assign:s,__rest:a,__decorate:o,__param:E,__esDecorate:c,__runInitializers:_,__propKey:l,__setFunctionName:d,__metadata:u,__awaiter:T,__generator:f,__createBinding:A,__exportStar:S,__values:h,__read:I,__spread:N,__spreadArrays:R,__spreadArray:p,__await:C,__asyncGenerator:m,__asyncDelegator:O,__asyncValues:D,__makeTemplateObject:v,__importStar:P,__importDefault:g,__classPrivateFieldGet:w,__classPrivateFieldSet:U,__classPrivateFieldIn:L,__addDisposableResource:G,__disposeResources:b,__rewriteRelativeImportExtension:F}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i=n(378);SFU=i})();